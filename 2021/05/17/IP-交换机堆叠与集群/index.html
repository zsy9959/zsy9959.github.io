<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="IP-16-交换机堆叠与集群," />










<meta name="description" content="前言•随着企业的发展，企业网络的规模越来越大，这对企业网络提出了更高的要求：更高的可靠性、更低的故障恢复时间、设备更加易于管理等。 •传统的园区网高可靠性技术出现故障时切换时间很难做到毫秒级别、实现可靠性的方案通常为一主一备，存在着严重的资源浪费。同时随着网络设备的越来越多，管理将会变得越加复杂。为构建可靠、易管理、资源利用率高、易于扩展的交换网络，引入了交换机堆叠、集群技术。 •本章节中将介绍交">
<meta property="og:type" content="article">
<meta property="og:title" content="IP-交换机堆叠与集群">
<meta property="og:url" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/index.html">
<meta property="og:site_name" content="zsy&#39;s blog">
<meta property="og:description" content="前言•随着企业的发展，企业网络的规模越来越大，这对企业网络提出了更高的要求：更高的可靠性、更低的故障恢复时间、设备更加易于管理等。 •传统的园区网高可靠性技术出现故障时切换时间很难做到毫秒级别、实现可靠性的方案通常为一主一备，存在着严重的资源浪费。同时随着网络设备的越来越多，管理将会变得越加复杂。为构建可靠、易管理、资源利用率高、易于扩展的交换网络，引入了交换机堆叠、集群技术。 •本章节中将介绍交">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/1.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/2.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/3.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/4.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/5.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/6.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/7.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/8.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/9.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/10.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/11.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/12.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/13.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/14.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/15.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/16.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/17.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/18.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/19.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/20.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/21.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/22.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/23.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/24.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/25.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/26.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/27.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/28.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/29.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/30.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/31.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/32.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/33.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/34.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/35.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/36.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/37.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/38.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/39.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/40.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/41.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/42.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/43.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/44.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/45.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/46.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/47.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/48.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/49.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/50.png">
<meta property="og:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/51.png">
<meta property="article:published_time" content="2021-05-17T03:17:56.000Z">
<meta property="article:modified_time" content="2021-05-28T10:37:32.926Z">
<meta property="article:author" content="张思宇">
<meta property="article:tag" content="IP-16-交换机堆叠与集群">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2021/05/17/IP-交换机堆叠与集群/"/>





  <title>IP-交换机堆叠与集群 | zsy's blog</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zsy's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">just simple</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/home" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mydog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zsy's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">IP-交换机堆叠与集群</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-17T11:17:56+08:00">
                2021-05-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>•随着企业的发展，企业网络的规模越来越大，这对企业网络提出了更高的要求：更高的可靠性、更低的故障恢复时间、设备更加易于管理等。</p>
<p>•传统的园区网高可靠性技术出现故障时切换时间很难做到毫秒级别、实现可靠性的方案通常为一主一备，存在着严重的资源浪费。同时随着网络设备的越来越多，管理将会变得越加复杂。为构建可靠、易管理、资源利用率高、易于扩展的交换网络，引入了交换机堆叠、集群技术。</p>
<p>•本章节中将介绍交换机堆叠、集群技术的技术原理、组网方式等。</p>
<h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>▫描述交换机堆叠、集群的基本概念</p>
<p>▫阐述堆叠、集群的建立过程</p>
<p>▫阐述堆叠、集群的分裂检测技术原理</p>
<h1 id="1-堆叠、集群技术概述"><a href="#1-堆叠、集群技术概述" class="headerlink" title="1.堆叠、集群技术概述"></a>1.堆叠、集群技术概述</h1><h2 id="堆叠、集群简介"><a href="#堆叠、集群简介" class="headerlink" title="堆叠、集群简介"></a>堆叠、集群简介</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/1.png"></p>
<blockquote>
<p>•堆叠（iStack），将多台支持堆叠特性的交换机通过堆叠线缆连接在一起，从逻辑上虚拟成一台交换设备，作为一个整体参与数据转发。</p>
<p>•集群（Cluster Switch System，CSS），将两台支持集群特性的交换机设备组合在一起，从逻辑上虚拟成一台交换设备。</p>
<p>•集群只支持两台设备，一般高端框式交换机支持CSS、盒式设备支持iStack。</p>
<p>•通过使用堆叠、集群技术结合链路聚合技术可以简单构建高可靠、无环的园区网络。</p>
</blockquote>
<h2 id="堆叠、集群架构"><a href="#堆叠、集群架构" class="headerlink" title="堆叠、集群架构"></a>堆叠、集群架构</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/2.png"></p>
<p>•使用堆叠、集群技术将独立的交换机虚拟化成一台逻辑的交换机，一般接入、汇聚层盒式交换机采用堆叠技术，汇聚、核心层交换机采用集群技术。</p>
<p>•在逻辑交换机之间使用链路聚合技术，无需部署STP、VRRP实现高可靠性。</p>
<p>•实现高可靠性的同时设备之间的链路可以同时传输流量，链路利用率得以提升。</p>
<h2 id="堆叠、集群的优势-1"><a href="#堆叠、集群的优势-1" class="headerlink" title="堆叠、集群的优势 (1)"></a>堆叠、集群的优势 (1)</h2><p>使用堆叠、集群可有效提高资源利用率，获得更高的转发性能、链路带宽。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/3.png"></p>
<h2 id="堆叠、集群的优势-2"><a href="#堆叠、集群的优势-2" class="headerlink" title="堆叠、集群的优势 (2)"></a>堆叠、集群的优势 (2)</h2><p>使用堆叠、集群可以降低网络规划的复杂度，方便对于网络的管理。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/4.png"></p>
<h2 id="堆叠、集群的优势-3"><a href="#堆叠、集群的优势-3" class="headerlink" title="堆叠、集群的优势 (3)"></a>堆叠、集群的优势 (3)</h2><p>使用堆叠、集群可以大大降低故障导致的业务中断时间。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/5.png"></p>
<h1 id="2-堆叠技术原理"><a href="#2-堆叠技术原理" class="headerlink" title="2.堆叠技术原理"></a>2.堆叠技术原理</h1><h2 id="堆叠基本概念"><a href="#堆叠基本概念" class="headerlink" title="堆叠基本概念"></a>堆叠基本概念</h2><p>•堆叠系统中所有的单台交换机都称为成员交换机，按照功能不同，可以分为三种角色：</p>
<ul>
<li><p>主交换机（Master）：主交换机负责管理整个堆叠。堆叠系统中只有一台主交换机。</p>
</li>
<li><p>备交换机（Standby）：备交换机是主交换机的备份交换机。堆叠系统中只有一台备交换机。当主交换机故障时，备交换机会接替原主交换机的所有业务。</p>
</li>
<li><p>从交换机（Slave）：从交换机用于业务转发，堆叠系统中可以有多台从交换机。从交换机数量越多，堆叠系统的转发带宽越大。除主交换机和备交换机外，堆叠中其他所有的成员交换机都是从交换机。当备交换机不可用时，从交换机承担备交换机的角色。</p>
</li>
</ul>
<p>•堆叠优先级：堆叠优先级是成员交换机的一个属性，主要用于角色选举过程中确定成员交换机的角色，优先级值越大表示优先级越高，优先级越高当选为主交换机的可能性越大。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/6.png"></p>
<h2 id="堆叠ID"><a href="#堆叠ID" class="headerlink" title="堆叠ID"></a>堆叠ID</h2><p>•堆叠ID，即成员交换机的槽位号（Slot ID），用来标识和管理成员交换机，堆叠中所有成员交换机的堆叠ID都是唯一的。</p>
<p>•设备堆叠ID缺省为0。堆叠时由堆叠主交换机对设备的堆叠ID进行管理，当堆叠系统有新成员加入时，如果新成员与已有成员堆叠ID冲突，则堆叠主交换机从0～最大的堆叠ID进行遍历，找到第一个空闲的ID分配给该新成员。</p>
<p>•在建立堆叠时，建议提前规划好设备的堆叠ID。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/7.png"></p>
<h2 id="堆叠逻辑接口"><a href="#堆叠逻辑接口" class="headerlink" title="堆叠逻辑接口"></a>堆叠逻辑接口</h2><p>•堆叠逻辑接口：交换机之间用于建立堆叠的逻辑接口，每台交换机支持两个逻辑堆叠端口，分别为stack-port n/1和stack-port n/2，其中n为成员交换机的堆叠ID。</p>
<p>•一个逻辑堆叠端口可以绑定多个物理成员端口，用来提高堆叠的可靠性和堆叠带宽。</p>
<p>•堆叠成员设备之间，本端设备的逻辑堆叠端口stack-port n/1必须与对端设备的逻辑堆叠端口stack-port m/2相连。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/8.png"></p>
<blockquote>
<p>•如果两端设备对应的逻辑堆叠端口（本端的stack-port n/1与对端的stack-port m/2）内包含多个物理成员端口，对物理成员端口的连接无对应端口号的要求。</p>
</blockquote>
<h2 id="堆叠系统组建过程"><a href="#堆叠系统组建过程" class="headerlink" title="堆叠系统组建过程"></a>堆叠系统组建过程</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/9.png"></p>
<h2 id="堆叠方式"><a href="#堆叠方式" class="headerlink" title="堆叠方式"></a>堆叠方式</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/10.png"></p>
<blockquote>
<p>•每台交换机支持两个逻辑堆叠端口，分别为stack-port n/1和stack-port n/2，其中n为成员交换机的堆叠ID。</p>
</blockquote>
<h2 id="堆叠连接拓扑"><a href="#堆叠连接拓扑" class="headerlink" title="堆叠连接拓扑"></a>堆叠连接拓扑</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/11.png"></p>
<h2 id="主交换机选举"><a href="#主交换机选举" class="headerlink" title="主交换机选举"></a>主交换机选举</h2><p>•确定出堆叠的连接方式和连接拓扑，完成成员交换机之间的物理连接之后，所有成员交换机上电。此时，堆叠系统开始进行主交换机的选举。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/12.png"></p>
<h2 id="备交换机选举"><a href="#备交换机选举" class="headerlink" title="备交换机选举"></a>备交换机选举</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/13.png"></p>
<h2 id="软件、配置同步"><a href="#软件、配置同步" class="headerlink" title="软件、配置同步"></a>软件、配置同步</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/14.png"></p>
<h2 id="堆叠管理与配置文件"><a href="#堆叠管理与配置文件" class="headerlink" title="堆叠管理与配置文件"></a>堆叠管理与配置文件</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/15.png"></p>
<blockquote>
<p>•堆叠系统的配置文件包括：</p>
<p>​    ▫全局配置：例如IP地址、STP、VLAN、SNMP等，适用于所有堆叠成员交换机。新加入堆叠系统的交换机使用堆叠系统的全局配置，不再使用交换机自己的全局配置。交换机离开堆叠系统时，将继续使用堆叠系统的配置直到加入新的堆叠系统。</p>
<p>​    ▫接口配置：适用于接口所在成员交换机。接口上的配置和堆叠ID有关，当堆叠ID改变时：</p>
<p>▪如果新ID在配置文件中不存在对应的接口配置，则新ID的接口配置使用默认配置。</p>
<p>▪如果新ID在配置文件中存在对应的接口配置，则新ID的接口配置使用对应的配置。</p>
<p>•堆叠相关配置不会丢失，即从设备离开堆叠之后，堆叠相关配置仍会继续存在，同样会进行堆叠的选举，如果需要彻底清除堆叠配置需要通过命令手动清除，清除的配置内容包括：</p>
<p>​    ▫交换机槽位号</p>
<p>​    ▫堆叠优先级</p>
<p>​    ▫堆叠保留VLAN</p>
<p>​    ▫系统MAC切换时间</p>
<p>​    ▫堆叠口配置</p>
<p>​    ▫堆叠口速率配置</p>
<p>​    执行该命令会导致设备重启</p>
</blockquote>
<h2 id="堆叠成员退出"><a href="#堆叠成员退出" class="headerlink" title="堆叠成员退出"></a>堆叠成员退出</h2><p>堆叠成员退出是指成员交换机从堆叠系统中离开。根据退出成员交换机角色的不同，对堆叠系统的影响也有所不同：</p>
<p>▫当主交换机退出，备份交换机升级为主交换机，重新计算堆叠拓扑并同步到其他成员交换机，指定新的备交换机，之后进入稳定运行状态。</p>
<p>▫当备交换机退出，主交换机重新指定备交换机，重新计算堆叠拓扑并同步到其他成员交换机，之后进入稳定运行状态。</p>
<p>▫当从交换机退出，主交换机重新计算堆叠拓扑并同步到其他成员交换机，之后进入稳定运行状态。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/16.png"></p>
<blockquote>
<p>•堆叠成员交换机退出的过程，主要就是拆除堆叠线缆和移除交换机的过程：</p>
<ul>
<li><p>对于环形堆叠：成员交换机退出后，为保证网络的可靠性还需要把退出交换机连接的两个端口通过堆叠线缆进行连接。</p>
</li>
<li><p>对于链形堆叠：拆除中间交换机会造成堆叠分裂。这时需要在拆除前进行业务分析，尽量减少对业务的影响。</p>
</li>
</ul>
</blockquote>
<h2 id="堆叠成员加入"><a href="#堆叠成员加入" class="headerlink" title="堆叠成员加入"></a>堆叠成员加入</h2><p>堆叠成员加入是指向已经稳定运行的堆叠系统添加一台新的交换机：</p>
<p>▫将未上电的交换机连线加入堆叠之后再上电启动，新加入的交换机会选举为从交换机，堆叠系统中原有主备从角色不变。</p>
<p>▫角色选举结束后，主交换机更新堆叠拓扑信息，同步到其他成员交换机上，并向新加入的交换机分配堆叠ID（新加入的交换机没有配置堆叠ID或配置的堆叠ID与原堆叠系统的冲突时）。</p>
<p>▫新加入的交换机更新堆叠ID，并同步主交换机的配置文件和系统软件，之后进入稳定运行状态。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/17.png"></p>
<blockquote>
<p>•未上电的交换机加入堆叠：</p>
<p>​    ▫如果是链形连接，新加入的交换机建议添加到链形的两端，这样对现有的业务影响最小。</p>
<p>​    ▫如果是环形连接，需要把当前环形拆成链形，然后在链形的两端添加设备。</p>
</blockquote>
<h2 id="堆叠合并"><a href="#堆叠合并" class="headerlink" title="堆叠合并"></a>堆叠合并</h2><p>•堆叠合并是指稳定运行的两个堆叠系统合并成一个新的堆叠系统。</p>
<p>•例如：已上电的一台交换机并且配置了堆叠（已形成单机堆叠），通过堆叠线缆与已经在运行的堆叠系统连接。该过程为堆叠合并，与堆叠加入不同。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/18.png"></p>
<blockquote>
<p>•单机堆叠：单机堆叠就是一台交换机使能了堆叠功能，整个堆叠系统中只有一台主交换机。只有使能了堆叠功能的交换机才可以加入堆叠系统或与其他使能了堆叠功能的交换机组建堆叠。</p>
<p>•堆叠合并过程如下：</p>
<p>▫两个堆叠系统的主交换机通过竞争，选举出一个更优的作为新堆叠系统的主交换机。</p>
<p>▫竞争成功的主交换机所在的堆叠系统将保持原有主备从角色和配置不变，业务也不会受到影响</p>
<p>▫而另外一个堆叠系统的所有成员交换机将重新启动，以从交换机的角色加入到新堆叠系统，其堆叠ID将由新主交换机重新分配，并将同步新主交换机的配置文件和系统软件，该堆叠系统的原有业务也将中断。</p>
</blockquote>
<h2 id="堆叠分裂"><a href="#堆叠分裂" class="headerlink" title="堆叠分裂"></a>堆叠分裂</h2><p>堆叠分裂是指稳定运行的堆叠系统中带电移出部分成员交换机，或者堆叠线缆多点故障导致一个堆叠系统变成多个堆叠系统。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/19.png"></p>
<h2 id="堆叠分裂引起的问题"><a href="#堆叠分裂引起的问题" class="headerlink" title="堆叠分裂引起的问题"></a>堆叠分裂引起的问题</h2><p>由于堆叠系统中所有成员交换机都使用同一个IP地址（VLANIF接口地址）和MAC地址（堆叠系统MAC），一个堆叠系统分裂后，可能产生多个具有相同IP地址和MAC地址的堆叠系统，从而引起网络故障，为此必须进行IP地址和MAC地址的冲突检查。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/20.png"></p>
<blockquote>
<p> •堆叠系统作为一台设备与网络中其他设备通信，具有唯一的MAC地址，称为堆叠系统MAC地址。通常情况下使用主交换机的MAC地址作为堆叠系统MAC地址。</p>
<p>•当堆叠系统的MAC地址是主交换机的MAC地址，主交换机故障或者离开堆叠系统，在默认情况下堆叠系统MAC地址会延时10分钟切换，即在10分钟内两个分裂的堆叠系统的MAC相同。</p>
</blockquote>
<h2 id="MAD"><a href="#MAD" class="headerlink" title="MAD"></a>MAD</h2><p>•多主检测MAD（Multi-Active Detection）：一种检测和处理堆叠分裂的协议，链路故障导致堆叠系统分裂后，MAD可以实现堆叠分裂的检测、冲突处理和故障恢复，降低堆叠分裂对业务的影响。</p>
<p>•MAD检测方式有两种：直连检测方式和代理检测方式。在同一个堆叠系统中，两种检测方式互斥，不可以同时配置。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/21.png"></p>
<blockquote>
<p>•分裂后的堆叠系统通过MAD检测线缆（普通线缆，手动配置为MAD检测链路）发送MAD检测报文进行竞选，竞选失败的堆叠系统会关闭所有的物理端口（手动配置的保留端口除外）以保证不会因IP、MAC冲突对业务产生影响。</p>
<p>•MAD检测过程如下：</p>
<p>▫堆叠分裂之后，分裂后的堆叠系统存在相同的IP地址、MAC地址（堆叠系统MAC），将会导致网络中表项错误，如下游设备的ARP表项、MAC地址表项，从而导致业务异常。</p>
<p>▫为此分类后的堆叠系统会通过MAC检测线缆进行竞选。</p>
<p>▫竞选失败者关闭自身物理接口，从而不会和竞选成功地堆叠系统产生IP地址、MAC地址冲突。</p>
</blockquote>
<h2 id="MAD检测-直连检测"><a href="#MAD检测-直连检测" class="headerlink" title="MAD检测 - 直连检测"></a>MAD检测 - 直连检测</h2><p>直连检测方式是指堆叠成员交换机间通过普通线缆直连的专用链路进行多主检测。在直连检测方式中，堆叠系统正常运行时，不发送MAD报文；堆叠系统分裂后，分裂后的两台交换机以1秒为周期通过检测链路发送MAD报文进行多主冲突处理。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/22.png"></p>
<blockquote>
<p>•通过中间设备直连可以实现通过中间设备缩短堆叠成员交换机之间的检测链路长度，适用于成员交换机相距较远的场景。与通过中间设备直连相比，Full-mesh方式直连可以避免由中间设备故障导致的MAD检测失败，但是每两台成员交换机之间都建立全连接会占用较多的接口，所以该方式适用于成员交换机数目较少的场景。</p>
</blockquote>
<h2 id="MAD检测-代理检测"><a href="#MAD检测-代理检测" class="headerlink" title="MAD检测 - 代理检测"></a>MAD检测 - 代理检测</h2><p>代理检测方式是在堆叠系统Eth-Trunk上启用代理检测，在代理设备上启用MAD检测功能。此种检测方式要求堆叠系统中的所有成员交换机都与代理设备连接，并将这些链路加入同一个Eth-Trunk内。与直连检测方式相比，代理检测方式无需占用额外的接口，Eth-Trunk接口可同时运行MAD代理检测和其他业务。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/23.png"></p>
<blockquote>
<p>•在代理检测方式中，堆叠系统正常运行时，堆叠成员交换机以30s为周期通过检测链路发送MAD报文。堆叠成员交换机对在正常工作状态下收到的MAD报文不做任何处理；堆叠分裂后，分裂后的两个堆叠系统以1s为周期通过检测链路发送MAD报文进行多主冲突处理。</p>
</blockquote>
<h2 id="MAD冲突处理-1"><a href="#MAD冲突处理-1" class="headerlink" title="MAD冲突处理 (1)"></a>MAD冲突处理 (1)</h2><p>堆叠分裂后，MAD冲突处理机制使用MAD报文进行MAD竞争，竞争结果为堆叠系统处于Detect状态或者Recovery状态：</p>
<p>▫Detect：竞争成功，堆叠系统将处于正常工作状态。</p>
<p>▫Recovery：竞争失败，堆叠系统将状态处于禁用状态，关闭除手动配置的保留端口以外的其它所有物理端口。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/24.png"></p>
<h2 id="MAD冲突处理-2"><a href="#MAD冲突处理-2" class="headerlink" title="MAD冲突处理 (2)"></a>MAD冲突处理 (2)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/25.png"></p>
<h2 id="堆叠主备倒换"><a href="#堆叠主备倒换" class="headerlink" title="堆叠主备倒换"></a>堆叠主备倒换</h2><p>•如果堆叠系统当前的主交换机不是用户期望的，此时可以通过配置主备倒换实现将堆叠备交换机升为堆叠主交换机。</p>
<p>•除了用户通过命令执行的主备倒换之外，主交换机故障重启也会引起主备倒换。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/26.png"></p>
<blockquote>
<p>•原来的备交换机升为主交换机</p>
<p>•新主交换机重新指定备交换机</p>
<p>•原来的主交换机重启后重新加入堆叠系统，并被选举为从交换机。</p>
</blockquote>
<h2 id="堆叠升级"><a href="#堆叠升级" class="headerlink" title="堆叠升级"></a>堆叠升级</h2><p>堆叠升级方式有三种：智能升级、传统升级和平滑升级。</p>
<p>▫智能升级：堆叠建立或者新的交换机加入堆叠时会自动和主交换机的版本进行同步。</p>
<p>▫传统升级：和普通设备升级一样，指定下次启动版本，重启整个堆叠系统进行升级，会造成较长时间的业务中断。</p>
<p>▫平滑升级：将堆叠系统划分成为active、backup区域，可以分区域升级，整个堆叠系统的上下行采用备份组网，主、备链路分别处于active、backup区域，可以实现升级时的业务不中断。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/27.png"></p>
<blockquote>
<p>•Active区域：主交换机所在的区域</p>
<p>•平滑升级的三个阶段：</p>
<p>▫主交换机下发命令触发整个堆叠系统进入平滑升级状态，backup区各个成员交换机以新的系统软件进行启动。</p>
<p>▫backup区以新版本建立一个独立的堆叠系统，并通知active区进入升级阶段，主控权由active区的主交换机转移到backup区的主交换机，backup区负责流量传输，active区进入升级过程。</p>
<p>▫active区以新系统软件重新启动并加入backup区的堆叠系统，backup区的主交换机根据最终堆叠建立的结果发布升级的结果。</p>
</blockquote>
<h2 id="跨设备链路聚合-1"><a href="#跨设备链路聚合-1" class="headerlink" title="跨设备链路聚合 (1)"></a>跨设备链路聚合 (1)</h2><p>•堆叠支持跨设备链路聚合技术，堆叠后成为逻辑上的一台交换机，支持将Eth-Trunk的成员接口分布在不同的成员交换机上。</p>
<p>•当其中一条聚合链路故障或堆叠中某台成员交换机故障时，Eth-Trunk接口通过堆叠线缆将流量重新分布到其他聚合链路上，实现了链路间和设备间的备份，保证了数据流量的可靠传输。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/28.png"></p>
<h2 id="跨设备链路聚合-2"><a href="#跨设备链路聚合-2" class="headerlink" title="跨设备链路聚合 (2)"></a>跨设备链路聚合 (2)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/29.png"></p>
<blockquote>
<p>•如上图所时，在上行链路出现故障时跨设备链路聚合技术能够通过堆叠线缆将流量负载分担到其他成员交换机上的成员接口，从而提高网络可靠性。</p>
<p>•跨成员设备的流量会经过堆叠线缆，如果跨成员设备流量较大，将会大大增加堆叠线缆的带宽压力。</p>
</blockquote>
<h2 id="流量本地优先转发-1"><a href="#流量本地优先转发-1" class="headerlink" title="流量本地优先转发 (1)"></a>流量本地优先转发 (1)</h2><p>链路聚合的负载分担算法根据流量特征将报文分担在不同的成员链路上，对于跨设备链路聚合极有可能出现报文的出接口和入接口不在同一台成员设备之上的情况，此时堆叠成员之间将会通过堆叠线缆转发流量，这增加了堆叠线缆的流量负担，同时也降低了转发效率。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/30.png"></p>
<blockquote>
<p>•如上图所示，当链路聚合将流量分担到其他成员设备上时，部分流量将会经过堆叠线缆转发，这会大大增加堆叠线缆的带宽承载压力。如果通过堆叠线缆需要转发的流量甚至超过了堆叠线缆的带宽，报文将无法及时得到传输。</p>
</blockquote>
<h2 id="流量本地优先转发-2"><a href="#流量本地优先转发-2" class="headerlink" title="流量本地优先转发 (2)"></a>流量本地优先转发 (2)</h2><p>为保证流量转发效率、降低堆叠线缆带宽负载，设备可以开启流量本地优先转发，从本设备进入的流量优先从本地转发出去，当本设备无出接口或者出接口全部故障，才会从其它成员交换机的接口转发出去。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/31.png"></p>
<h1 id="3-集群技术原理"><a href="#3-集群技术原理" class="headerlink" title="3.集群技术原理"></a>3.<strong>集群技术原理</strong></h1><h2 id="集群介绍"><a href="#集群介绍" class="headerlink" title="集群介绍"></a>集群介绍</h2><p>•集群交换机系统CSS（Cluster Switch System），又称为集群，是指将两台支持集群特性的交换机设备组合在一起，从逻辑上虚拟成一台交换设备。</p>
<p>•CSS与iStack的区别在于，一般框式交换机堆叠称为CSS，盒式交换机称为堆叠，堆叠与集群两者只是叫法和实现有些差异，但是功能是一样的。</p>
<p>•本小节着重介绍集群与堆叠存在的差异之处。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/32.png"></p>
<h2 id="集群基本概念"><a href="#集群基本概念" class="headerlink" title="集群基本概念"></a>集群基本概念</h2><p>•集群中的单台交换机称为集群成员交换机，按照功能不同，可以分为两种角色：</p>
<p>▫主交换机（Master）：主交换机，即Master，负责管理整个集群。</p>
<p>▫备交换机（Standby）：备交换机，即Standby，是主交换机的备份交换机。</p>
<p>•集群ID：即CSS ID，用来标识成员交换机，集群中成员交换机的集群ID是唯一的。</p>
<p>•CSS Link：集群链路，专门用于组建集群，实现主交换机和备交换机之间数据通信。</p>
<p>•集群优先级：即CSS Priority，主要用于角色选举过程中确定成员交换机的角色。优先级值越大优先级越高。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/33.png"></p>
<blockquote>
<p>•备交换机，即Standby，是主交换机的备份交换机。当主交换机故障时，备交换机会接替原主交换机的所有业务。集群中只有一台备交换机。</p>
<p>•集群链路可以是一条链路，也可以是捆绑在一起的多条链路。</p>
<p>•缺省情况下，交换机的集群ID为1。相同ID的两台交换机不能建立集群，所以在建立集群前，需要手工配置集群中一台交换机的集群ID为2。</p>
<p>•交换机的集群优先级越高当选为主交换机的可能性越大，但选举主交换机比较的不止优先级。</p>
</blockquote>
<h2 id="集群控制平面"><a href="#集群控制平面" class="headerlink" title="集群控制平面"></a>集群控制平面</h2><p>•两台交换机使用集群线缆连接好，分别使能集群功能并完成配置后重启，集群系统会自动建立。</p>
<p>•集群系统建立后，在控制平面上，主交换机的主用主控板成为集群系统的控制平面，作为整个系统的管理主角色。备交换机的主用主控板成为集群系统的备用控制平面，作为系统的管理备角色。主交换机和备交换机的备用主控板作为集群系统候选备用主控板。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/34.png"></p>
<blockquote>
<p>•集群主交换机选举规则与堆叠选举规则一致，另外一台交换机则是备交换机。</p>
</blockquote>
<h2 id="集群物理连接"><a href="#集群物理连接" class="headerlink" title="集群物理连接"></a>集群物理连接</h2><p>根据集群技术发展阶段不同，集群物理连接方式也存在区别：</p>
<p>▫传统CSS：使用主控板上的集群卡建立集群连接，或者使用业务口建立集群连接。</p>
<p>▫CSS2：第二代集群交换机系统，专指使用交换网板上的集群卡方式建立集群连接的集群。</p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/35.png"></p>
<blockquote>
<p>•使用业务口连接时两端成员接口数量、类型相同，接线顺序无限制。</p>
<p>•业务口集群按照链路的分布，有两种组网形式：</p>
<ul>
<li><p>1+0组网：每台成员交换机配置一个逻辑集群端口，物理成员端口分布在一块业务板上，依靠一块业务板上物理成员端口与对框的物理成员端口实现集群连接。</p>
</li>
<li><p>1+1组网：每台成员交换机配置两个逻辑集群端口，物理成员端口分布在两块业务板上，如图所示，不同业务板上的集群链路形成备份。</p>
</li>
</ul>
<p>•CSS2：专指交换网板上通过集群卡方式建立的交换网硬件集群，并且在原有集群技术的基础上，增加了集群主控1+N备份等技术。</p>
</blockquote>
<h2 id="传统CSS"><a href="#传统CSS" class="headerlink" title="传统CSS"></a>传统CSS</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/36.png"></p>
<p>•对于只支持CSS构架的框式交换机，框内接口板之间流量、跨框流量必须经过主控板。</p>
<p>•单框上没有正常工作的主控板时流量无法从一个接口板转发到另外一个接口板，同时也无法跨框转发到另一个框。</p>
<h2 id="CSS2"><a href="#CSS2" class="headerlink" title="CSS2"></a>CSS2</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/37.png"></p>
<p>•支持CSS2构架的框式交换机采用转控分离的构架，单框内接口板之间流量、跨框流量无需经过主控板，集群系统内单台框无能够正常工作的主控板不影响该框的流量转发。</p>
<p>•CSS2支持任意一个框式交换机内存在一个主控板运行正常，集群的两个框式交换机上的接口板都可以正常转发报文，该特性被称为“集群主控1+N备份”。</p>
<h1 id="4-基本配置"><a href="#4-基本配置" class="headerlink" title="4.基本配置"></a>4.基本配置</h1><h2 id="堆叠配置-1"><a href="#堆叠配置-1" class="headerlink" title="堆叠配置 (1)"></a>堆叠配置 (1)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/38.png"></p>
<h2 id="堆叠配置-2"><a href="#堆叠配置-2" class="headerlink" title="堆叠配置 (2)"></a>堆叠配置 (2)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/39.png"></p>
<h2 id="堆叠配置-3"><a href="#堆叠配置-3" class="headerlink" title="堆叠配置 (3)"></a>堆叠配置 (3)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/40.png"></p>
<h2 id="堆叠配置-4"><a href="#堆叠配置-4" class="headerlink" title="堆叠配置 (4)"></a>堆叠配置 (4)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/41.png"></p>
<h2 id="堆叠配置案例"><a href="#堆叠配置案例" class="headerlink" title="堆叠配置案例"></a>堆叠配置案例</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/42.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/43.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/44.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/45.png"></p>
<h2 id="集群配置-1"><a href="#集群配置-1" class="headerlink" title="集群配置 (1)"></a>集群配置 (1)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/46.png"></p>
<h2 id="集群配置-2"><a href="#集群配置-2" class="headerlink" title="集群配置 (2)"></a>集群配置 (2)</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/47.png"></p>
<blockquote>
<p>•集群的MAD检测功能，配置方式、配置命令与堆叠一致。</p>
</blockquote>
<h2 id="集群配置案例"><a href="#集群配置案例" class="headerlink" title="集群配置案例"></a>集群配置案例</h2><p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/48.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/49.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/50.png"></p>
<p><img src="/2021/05/17/IP-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/51.png"></p>
<h1 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h1><p>1.（简答题）堆叠加入与堆叠合并有什么区别？</p>
<p><strong>堆叠加入是交换机未上电之前已经通过堆叠线缆连接到了已有的堆叠系统，当上电启动之后因为堆叠系统已经存在主交换机，所以该交换机只会竞选成为从交换机。堆叠合并是两个堆叠系统通过堆叠线缆连在一起，此时两个堆叠系统会竞选新的主交换机并更新拓扑。<br> 一台交换机已经上电之后自身会成为一个堆叠系统并且由于没有竞争者自己会成为主交换机，这种情况下把该交换机通过堆叠线缆与另外一个堆叠系统相连就属于堆叠合并，这是一种典型的堆叠合并与堆叠加入的差异性场景。</strong></p>
<p>2.（简答题）多主检测的目的是？多主检测失败的一方会采取什么操作？</p>
<p><strong>防止堆叠、集群分裂之后相同的IP地址、MAC地址造成网络中其他网络设备的表项冲突，从而导致转发异常。检测失败的一方将会关闭除保留端口之外的所有端口，从而避免相同IP地址、相同MAC地址对其他网络设备造成表项冲突。</strong></p>
<p>3.（简答题） CSS2相比较于传统CSS区别在于？</p>
<p><strong>CSS2支持1+N主控备份，整个集群系统中只要有一个主控板处于工作状态，整个集群系统的控制平面可以正常工作的情况下，集群系统整体的数据平面就可以正常转发报文。</strong></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>•堆叠、集群技术大大简化了网络部署的复杂化、降低了网络管理的复杂度，实现了快速部署高可靠、无环的园区网络，同时也极大地降低了网络故障的影响时间。</p>
<p>•为防止相同的IP地址、MAC地址造成的转发异常，可以配置MAD检测，MAD检测分为直接连接的检测方式以及代理设备检测，MAD竞争失败的一方会关闭除保留端口之外的所有物理端口。</p>
<p>•为保证报文的转发效率，在堆叠、集群上部署Eth-Trunk时尽量开启本地优先转发尽量避免跨框流量的产生。</p>
<p>•CSS2技术通过交换网板上的集群卡进行集群，结合交换机转控分离的构架，可以实现主控的1+N备份。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/IP-16-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%A0%86%E5%8F%A0%E4%B8%8E%E9%9B%86%E7%BE%A4/" rel="tag"># IP-16-交换机堆叠与集群</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/05/16/IP-%E5%9B%AD%E5%8C%BA%E7%BD%91%E5%85%B8%E5%9E%8B%E6%8A%80%E6%9C%AF%E5%BA%94%E7%94%A8%E6%A6%82%E8%BF%B0/" rel="next" title="IP-园区网典型技术应用概述">
                <i class="fa fa-chevron-left"></i> IP-园区网典型技术应用概述
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/05/17/IP-IP%E7%BB%84%E6%92%AD%E5%9F%BA%E7%A1%80/" rel="prev" title="IP-IP组播基础">
                IP-IP组播基础 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/mydog.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">72</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">74</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zsy9959" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:zsy9959@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0"><span class="nav-number">3.</span> <span class="nav-text">1.堆叠、集群技术概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E7%AE%80%E4%BB%8B"><span class="nav-number">3.1.</span> <span class="nav-text">堆叠、集群简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84"><span class="nav-number">3.2.</span> <span class="nav-text">堆叠、集群架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E7%9A%84%E4%BC%98%E5%8A%BF-1"><span class="nav-number">3.3.</span> <span class="nav-text">堆叠、集群的优势 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E7%9A%84%E4%BC%98%E5%8A%BF-2"><span class="nav-number">3.4.</span> <span class="nav-text">堆叠、集群的优势 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E3%80%81%E9%9B%86%E7%BE%A4%E7%9A%84%E4%BC%98%E5%8A%BF-3"><span class="nav-number">3.5.</span> <span class="nav-text">堆叠、集群的优势 (3)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-%E5%A0%86%E5%8F%A0%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">2.堆叠技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">4.1.</span> <span class="nav-text">堆叠基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0ID"><span class="nav-number">4.2.</span> <span class="nav-text">堆叠ID</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%80%BB%E8%BE%91%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.3.</span> <span class="nav-text">堆叠逻辑接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E7%B3%BB%E7%BB%9F%E7%BB%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">4.4.</span> <span class="nav-text">堆叠系统组建过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%96%B9%E5%BC%8F"><span class="nav-number">4.5.</span> <span class="nav-text">堆叠方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E8%BF%9E%E6%8E%A5%E6%8B%93%E6%89%91"><span class="nav-number">4.6.</span> <span class="nav-text">堆叠连接拓扑</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%80%89%E4%B8%BE"><span class="nav-number">4.7.</span> <span class="nav-text">主交换机选举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%87%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%80%89%E4%B8%BE"><span class="nav-number">4.8.</span> <span class="nav-text">备交换机选举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AF%E4%BB%B6%E3%80%81%E9%85%8D%E7%BD%AE%E5%90%8C%E6%AD%A5"><span class="nav-number">4.9.</span> <span class="nav-text">软件、配置同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E7%AE%A1%E7%90%86%E4%B8%8E%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.10.</span> <span class="nav-text">堆叠管理与配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%88%90%E5%91%98%E9%80%80%E5%87%BA"><span class="nav-number">4.11.</span> <span class="nav-text">堆叠成员退出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%88%90%E5%91%98%E5%8A%A0%E5%85%A5"><span class="nav-number">4.12.</span> <span class="nav-text">堆叠成员加入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E5%90%88%E5%B9%B6"><span class="nav-number">4.13.</span> <span class="nav-text">堆叠合并</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E5%88%86%E8%A3%82"><span class="nav-number">4.14.</span> <span class="nav-text">堆叠分裂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E5%88%86%E8%A3%82%E5%BC%95%E8%B5%B7%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">4.15.</span> <span class="nav-text">堆叠分裂引起的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAD"><span class="nav-number">4.16.</span> <span class="nav-text">MAD</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAD%E6%A3%80%E6%B5%8B-%E7%9B%B4%E8%BF%9E%E6%A3%80%E6%B5%8B"><span class="nav-number">4.17.</span> <span class="nav-text">MAD检测 - 直连检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAD%E6%A3%80%E6%B5%8B-%E4%BB%A3%E7%90%86%E6%A3%80%E6%B5%8B"><span class="nav-number">4.18.</span> <span class="nav-text">MAD检测 - 代理检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAD%E5%86%B2%E7%AA%81%E5%A4%84%E7%90%86-1"><span class="nav-number">4.19.</span> <span class="nav-text">MAD冲突处理 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAD%E5%86%B2%E7%AA%81%E5%A4%84%E7%90%86-2"><span class="nav-number">4.20.</span> <span class="nav-text">MAD冲突处理 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E4%B8%BB%E5%A4%87%E5%80%92%E6%8D%A2"><span class="nav-number">4.21.</span> <span class="nav-text">堆叠主备倒换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E5%8D%87%E7%BA%A7"><span class="nav-number">4.22.</span> <span class="nav-text">堆叠升级</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%A8%E8%AE%BE%E5%A4%87%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88-1"><span class="nav-number">4.23.</span> <span class="nav-text">跨设备链路聚合 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%A8%E8%AE%BE%E5%A4%87%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88-2"><span class="nav-number">4.24.</span> <span class="nav-text">跨设备链路聚合 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E6%9C%AC%E5%9C%B0%E4%BC%98%E5%85%88%E8%BD%AC%E5%8F%91-1"><span class="nav-number">4.25.</span> <span class="nav-text">流量本地优先转发 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E6%9C%AC%E5%9C%B0%E4%BC%98%E5%85%88%E8%BD%AC%E5%8F%91-2"><span class="nav-number">4.26.</span> <span class="nav-text">流量本地优先转发 (2)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-%E9%9B%86%E7%BE%A4%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86"><span class="nav-number">5.</span> <span class="nav-text">3.集群技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E4%BB%8B%E7%BB%8D"><span class="nav-number">5.1.</span> <span class="nav-text">集群介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">5.2.</span> <span class="nav-text">集群基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2"><span class="nav-number">5.3.</span> <span class="nav-text">集群控制平面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E7%89%A9%E7%90%86%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.4.</span> <span class="nav-text">集群物理连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%A0%E7%BB%9FCSS"><span class="nav-number">5.5.</span> <span class="nav-text">传统CSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSS2"><span class="nav-number">5.6.</span> <span class="nav-text">CSS2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="nav-number">6.</span> <span class="nav-text">4.基本配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%85%8D%E7%BD%AE-1"><span class="nav-number">6.1.</span> <span class="nav-text">堆叠配置 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%85%8D%E7%BD%AE-2"><span class="nav-number">6.2.</span> <span class="nav-text">堆叠配置 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%85%8D%E7%BD%AE-3"><span class="nav-number">6.3.</span> <span class="nav-text">堆叠配置 (3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%85%8D%E7%BD%AE-4"><span class="nav-number">6.4.</span> <span class="nav-text">堆叠配置 (4)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B"><span class="nav-number">6.5.</span> <span class="nav-text">堆叠配置案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE-1"><span class="nav-number">6.6.</span> <span class="nav-text">集群配置 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE-2"><span class="nav-number">6.7.</span> <span class="nav-text">集群配置 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B"><span class="nav-number">6.8.</span> <span class="nav-text">集群配置案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%9D%E8%80%83%E9%A2%98"><span class="nav-number">7.</span> <span class="nav-text">思考题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张思宇</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
