<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="IP-3-OSPF基础," />










<meta name="description" content="前言•路由器根据路由表转发数据包，路由表项可通过手动配置和动态路由协议生成。 •静态路由比动态路由使用更少的带宽，并且不占用CPU资源来计算和分析路由更新。当网络结构比较简单时，只需配置静态路由就可以使网络正常工作。但是当网络发生故障或者拓扑发生变化后，静态路由不会自动更新，必须手动重新配置。 •相比较于静态路由，动态路由协议具有更强的可扩展性，具备更强的应变能力。 •OSPF（Open Shor">
<meta property="og:type" content="article">
<meta property="og:title" content="IP-OSPF基础">
<meta property="og:url" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="zsy&#39;s blog">
<meta property="og:description" content="前言•路由器根据路由表转发数据包，路由表项可通过手动配置和动态路由协议生成。 •静态路由比动态路由使用更少的带宽，并且不占用CPU资源来计算和分析路由更新。当网络结构比较简单时，只需配置静态路由就可以使网络正常工作。但是当网络发生故障或者拓扑发生变化后，静态路由不会自动更新，必须手动重新配置。 •相比较于静态路由，动态路由协议具有更强的可扩展性，具备更强的应变能力。 •OSPF（Open Shor">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/1.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/2.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/3.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/4.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/5.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/6.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/7.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/8.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/9.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/10.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/11.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/12.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/13.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/14.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/15.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/16.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/17.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/18.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/19.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/20.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/21.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/23.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/24.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/25.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/26.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/28.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/29.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/30.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/31.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/32.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/33.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/34.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/35.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/36.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/37.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/38.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/39.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/40.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/41.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/42.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/43.png">
<meta property="og:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/44.png">
<meta property="article:published_time" content="2021-05-06T09:14:14.000Z">
<meta property="article:modified_time" content="2021-05-21T06:22:51.463Z">
<meta property="article:author" content="张思宇">
<meta property="article:tag" content="IP-3-OSPF基础">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2021/05/06/OSPF基础/"/>





  <title>IP-OSPF基础 | zsy's blog</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zsy's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">just simple</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/home" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mydog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zsy's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">IP-OSPF基础</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-06T17:14:14+08:00">
                2021-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>•路由器根据路由表转发数据包，路由表项可通过手动配置和动态路由协议生成。</p>
<p>•静态路由比动态路由使用更少的带宽，并且不占用CPU资源来计算和分析路由更新。当网络结构比较简单时，只需配置静态路由就可以使网络正常工作。但是当网络发生故障或者拓扑发生变化后，静态路由不会自动更新，必须手动重新配置。</p>
<p>•相比较于静态路由，动态路由协议具有更强的可扩展性，具备更强的应变能力。</p>
<p>•OSPF（Open Shortest Path First，开放式最短路径优先）具有扩展性强，收敛速度快等特点，作为优秀的内部网关协议被广泛使用。</p>
<h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>▫描述OSPF路由计算的整体过程</p>
<p>▫阐明DR与BDR的作用</p>
<p>▫描述OSPF报文类型和作用</p>
<p>▫实现OSPF的基本配置</p>
<p>▫区分OSPF邻居关系和邻接关系</p>
<h1 id="动态路由协议简介"><a href="#动态路由协议简介" class="headerlink" title="动态路由协议简介"></a><strong>动态路由协议简介</strong></h1><h2 id="动态路由协议的分类"><a href="#动态路由协议的分类" class="headerlink" title="动态路由协议的分类"></a><strong>动态路由协议的分类</strong></h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/1.png"></p>
<blockquote>
<p>•BGP使用一种基于距离矢量算法修改后的算法，该算法被称为路径矢量（Path Vector）算法。因此在某些场合下，BGP也被称为路径矢量路由协议。</p>
<p>•IGP（内部网关协议）在同一个自治系统内交换路由信息，IGP的主要目的是发现和计算自治域内的路由信息。</p>
<p>•EGP（外部网关协议）主要用于AS（自治系统）之间的互联。</p>
</blockquote>
<h2 id="距离矢量路由协议"><a href="#距离矢量路由协议" class="headerlink" title="距离矢量路由协议"></a><strong>距离矢量路由协议</strong></h2><p>•运行距离矢量路由协议的路由器周期性地泛洪自己的路由表。通过路由的交互，每台路由器都从相邻的路由器学习到路由，并且加载进自己的路由表中，然后再通告给其他相邻路由器。</p>
<p>•对于网络中的所有路由器而言，路由器并不清楚网络的拓扑，只是简单的知道要去往某个目的网段方向在哪里，开销有多大。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/2.png"> </p>
<h2 id="链路状态路由协议-LSA泛洪"><a href="#链路状态路由协议-LSA泛洪" class="headerlink" title="链路状态路由协议 - LSA泛洪"></a>链路状态路由协议 - LSA泛洪</h2><p>•链路状态路由协议通告的的是链路状态而不是路由信息。</p>
<p>•运行链路状态路由协议的路由器之间首先会建立邻居关系，然后彼此之间开始交互LSA（Link State Advertisement，链路状态通告）。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/3.png"></p>
<blockquote>
<p>•链路状态通告，可以简单的理解为每台路由器都产生一个描述自己直连接口状态（包括接口的开销、与邻居路由器之间的关系等）的通告。</p>
</blockquote>
<h2 id="链路状态路由协议-LSDB维护"><a href="#链路状态路由协议-LSDB维护" class="headerlink" title="链路状态路由协议 - LSDB维护"></a>链路状态路由协议 - LSDB维护</h2><p>每台路由器都会产生LSA，路由器将接收到的LSA放入自己的LSDB（Link State DataBase，链路状态数据库）。路由器通过对LSDB中所存储的LSA进行解析，进而了解全网拓扑。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/4.png"></p>
<h2 id="链路状态路由协议-SPF计算"><a href="#链路状态路由协议-SPF计算" class="headerlink" title="链路状态路由协议 - SPF计算"></a>链路状态路由协议 - SPF计算</h2><p>每台路由器基于LSDB，使用SPF（Shortest Path First，最短路径优先）算法进行计算。每台路由器都计算出一棵以自己为根的、无环的、拥有最短路径的“树”。有了这棵“树”，路由器就已经知道了到达所有网段的优选路径。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/5.png"></p>
<blockquote>
<p>•SPF是OSPF路由协议的一个核心算法，用来在一个复杂的网络中做出路由优选的决策。</p>
</blockquote>
<h2 id="链路状态路由协议-路由表生成"><a href="#链路状态路由协议-路由表生成" class="headerlink" title="链路状态路由协议 - 路由表生成"></a>链路状态路由协议 - 路由表生成</h2><p>路由器将计算出来的优选路径，加载进自己的路由表（Routing Table）。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/6.png"></p>
<h2 id="链路状态路由协议总结"><a href="#链路状态路由协议总结" class="headerlink" title="链路状态路由协议总结"></a>链路状态路由协议总结</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/7.png"></p>
<blockquote>
<p>链路状态路由协议有四个步骤：</p>
<p>▫第一步是建立相邻路由器之间的邻居关系。</p>
<p>▫第二步是邻居之间交互链路状态信息和同步LSDB。</p>
<p>▫第三步是进行优选路径计算。</p>
<p>▫第四步是根据最短路径树生成路由表项加载到路由表。</p>
</blockquote>
<h1 id="OSPF简介"><a href="#OSPF简介" class="headerlink" title="OSPF简介"></a>OSPF简介</h1><h2 id="OSPF概述"><a href="#OSPF概述" class="headerlink" title="OSPF概述"></a>OSPF概述</h2><p>•OSPF是IETF定义的一种基于链路状态的内部网关路由协议。目前针对IPv4协议使用的是OSPF Version 2（RFC2328）；针对IPv6协议使用OSPF Version 3（RFC2740）。</p>
<p>•OSPF有以下优点：</p>
<p>▫基于SPF算法，以“累计链路开销”作为选路参考值</p>
<p>▫采用组播形式收发部分协议报文</p>
<p>▫支持区域划分</p>
<p>▫支持对等价路由进行负载分担</p>
<p>▫支持报文认证</p>
<h2 id="OSPF应用场景"><a href="#OSPF应用场景" class="headerlink" title="OSPF应用场景"></a>OSPF应用场景</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/8.png"></p>
<p>•接入层：接入层利用光纤、双绞线、同轴电缆、无线接入技术等传输介质，实现与用户连接，并进行业务和带宽的分配。接入层目的是允许终端用户连接到网络，因此接入层交换机具有低成本和高端口密度特性。</p>
<p>•汇聚层：汇聚层为接入层提供基于策略的连接，如地址合并，协议过滤,路由服务，认证管理等。通过网段划分实现与网络隔离，可以防止网络故障蔓延和影响到核心层。汇聚层同时也可以提供接入层虚拟网之间的互连，控制和限制接入层对核心层的访问，保证核心层的安全和稳定。</p>
<p>•核心层：核心层的功能主要是实现骨干网络之间的优化传输，核心层任务的重点通常是冗余能力、可靠性和高速的传输。</p>
<h2 id="OSPF基础术语-Router-ID"><a href="#OSPF基础术语-Router-ID" class="headerlink" title="OSPF基础术语 - Router ID"></a>OSPF基础术语 - Router ID</h2><p>•Router ID用于在自治系统中唯一标识一台运行OSPF的路由器，它是一个32位的无符号整数。</p>
<p>•Router ID选举规则如下：</p>
<p>▫手动配置OSPF路由器的Router ID（建议手动配置）</p>
<p>▫如果没有手动配置Router ID，则路由器使用Loopback接口中最大的IP地址作为Router ID</p>
<p>▫如果没有配置Loopback接口，则路由器使用物理接口中最大的IP地址作为Router ID</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/9.png"></p>
<blockquote>
<p>•Router ID一旦选定，之后如果要更改的话就需要重启OSPF进程。</p>
<p>•在实际工程中，推荐手工指定OSPF路由设备的Router ID。首先规划出一个私有网段用于OSPF的Router ID选择，例如：192.168.1.0/24。在启用OSPF进程前在每个OSPF路由器上建立一个Loopback接口，使用一个32位掩码的私有地址作为其IP地址，这个32位的私有地址即作为该路由设备的Router ID。如果没有特殊要求，这个Loopback接口地址可以不发布在OSPF网络中。</p>
</blockquote>
<h2 id="OSPF基础术语-区域"><a href="#OSPF基础术语-区域" class="headerlink" title="OSPF基础术语 - 区域"></a>OSPF基础术语 - 区域</h2><p>•OSPF Area用于标识一个OSPF的区域。</p>
<p>•区域是从逻辑上将设备划分为不同的组，每个组用区域号（Area ID）来标识。</p>
<p>•OSPF的区域ID是一个32bit的非负整数，按点分十进制的形式（与IPv4地址的格式一样）呈现，例如Area0.0.0.1。为了简便起见，我们也会采用十进制的形式来表示。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/10.png"></p>
<blockquote>
<p>•几个例子：Area0.0.0.1等同于Area1，Area0.0.0.255等同于Area255，Area0.0.1.0等同于Area256。许多网络厂商的设备同时支持这两种区域ID配置及表示方式。</p>
</blockquote>
<h2 id="OSPF基础术语-度量值"><a href="#OSPF基础术语-度量值" class="headerlink" title="OSPF基础术语 - 度量值"></a>OSPF基础术语 - 度量值</h2><p>•OSPF使用Cost（开销）作为路由的度量值。每一个激活了OSPF的接口都会维护一个接口Cost值，缺省的接口Cost = “100 Mbit/s “ /“接口带宽” 。其中100 “Mbit/s”为OSPF指定的缺省参考值，该值是可配置的。</p>
<p>•OSPF以“累计cost”为开销值，也就是流量从源网络到目的网络所经过所有路由器的出接口的cost总和。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/11.png"></p>
<blockquote>
<p>•在实际应用中，推荐根据接口带宽大小手动配置Cost值，而不是修改OSPF参考带宽。</p>
</blockquote>
<h2 id="OSPF基础术语-度量值修改举例"><a href="#OSPF基础术语-度量值修改举例" class="headerlink" title="OSPF基础术语 - 度量值修改举例"></a>OSPF基础术语 - 度量值修改举例</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/12.png"></p>
<blockquote>
<p>•在规划流量路径时，推荐将汇聚层直连链路Cost值&gt;接入环所有链路Cost值之和，这样可以保证从接入层访问R1或R2时，流量可通过接入层路由器直达R1或R2。</p>
<p>•以上图为例。R1和R2位于企业网中的汇聚层，R1和R2的直连链路属于区域0，R1有一个直连网段10.0.1.1/32通过在区域0。</p>
<p>​    ▫在缺省情况下，R4到达10.0.1.1/32的路由存在两个下一跳。</p>
<p>​    ▫修改Cost之后，R4到达10.0.1.1的路由仅存在一个下一跳。</p>
</blockquote>
<h2 id="OSPF三大表项-邻居表"><a href="#OSPF三大表项-邻居表" class="headerlink" title="OSPF三大表项 - 邻居表"></a>OSPF三大表项 - 邻居表</h2><p>OSPF有三张重要的表项，OSPF邻居表、LSDB和OSPF路由表。对于OSPF的邻居表，需要了解：</p>
<p>▫OSPF在传递链路状态信息之前，需先建立OSPF邻居关系。</p>
<p>▫OSPF的邻居关系通过交互Hello报文建立。</p>
<p>▫OSPF邻居表显示了OSPF路由器之间的邻居状态，使用display ospf peer查看。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/13.png"></p>
<h2 id="OSPF三大表项-LSDB"><a href="#OSPF三大表项-LSDB" class="headerlink" title="OSPF三大表项 - LSDB"></a>OSPF三大表项 - LSDB</h2><p>对于OSPF的LSDB，需要了解：</p>
<p>▫LSDB会保存自己产生的及从邻居收到的LSA信息，本例中R1的LSDB包含了三条LSA。</p>
<p>▫Type标识LSA的类型，AdvRouter标识发送LSA的路由器。</p>
<p>▫使用命令行display ospf lsdb查看LSDB表。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/14.png"></p>
<h2 id="OSPF三大表项-OSPF路由表"><a href="#OSPF三大表项-OSPF路由表" class="headerlink" title="OSPF三大表项 - OSPF路由表"></a>OSPF三大表项 - OSPF路由表</h2><p>对于OSPF的路由表，需要了解：</p>
<p>▫OSPF路由表和路由器路由表是两张不同的表。本例中OSPF路由表有三条路由。</p>
<p>▫OSPF路由表包含Destination、Cost和NextHop等指导转发的信息。</p>
<p>▫使用命令display ospf routing查看OSPF路由表。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/15.png"></p>
<blockquote>
<p>•路由器路由表通常称为全局路由表，并非所有OSPF路由都可以放到路由器路由表。</p>
</blockquote>
<h2 id="OSPF报文格式和类型"><a href="#OSPF报文格式和类型" class="headerlink" title="OSPF报文格式和类型"></a>OSPF报文格式和类型</h2><p>•OSPF一共定义了5种类型的报文，不同类型的OSPF报文有相同的头部格式。</p>
<p>•OSPF报文直接采用IP封装，在报文的IP头部中，协议号为89。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/16.png"></p>
<blockquote>
<p>•重要字段解释</p>
<p>▫Version ：对于当前所使用的OSPFv2，该字段的值为2。</p>
<p>▫Router ID：表示生成此报文的路由器的Router ID。</p>
<p>▫Area ID：表示此报文需要被通告到的区域。</p>
<p>▫Type：类型字段。</p>
<p>▫Packet length：表示整个OSPF报文的长度，单位是字节。</p>
<p>▫Checksum：校验字段，其校验的范围是整个OSPF报文，包括OSPF报文头部。</p>
<p>▫Auth Type：为0时表示不认证；为1时表示简单的明文密码认证；为2时表示加密（MD5）认证。</p>
<p>▫Authentication：认证所需的信息。该字段的内容随AuType的值不同而不同。</p>
</blockquote>
<h1 id="OSPF工作过程"><a href="#OSPF工作过程" class="headerlink" title="OSPF工作过程"></a>OSPF工作过程</h1><h2 id="OSPF工作过程概览"><a href="#OSPF工作过程概览" class="headerlink" title="OSPF工作过程概览"></a>OSPF工作过程概览</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/17.png"></p>
<h2 id="建立邻居关系"><a href="#建立邻居关系" class="headerlink" title="建立邻居关系"></a>建立邻居关系</h2><p>•OSPF使用Hello报文发现和建立邻居关系。</p>
<p>•在以太网链路上，缺省时，OSPF采用组播的形式发送Hello报文（目的地址224.0.0.5）。</p>
<p>•OSPF Hello报文中包含了路由器的Router ID、邻居列表等信息。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/18.png"></p>
<blockquote>
<p>•R1和R2路由器相互发送Hello报文，第一个Hello报文包含的邻居列表为空。</p>
<p>•R2收到R1发送的Hello报文后，如果各项参数匹配，再次发送Hello报文时，将R1加入自己的邻居列表。</p>
<p>•在以太网链路上，通常以组播形式发送Hello报文：</p>
<p>​    ▫224.0.0.5的组播地址为OSPF设备的预留IP组播地址。</p>
<p>​    ▫224.0.0.6的组播地址为OSPF DR/BDR的预留IP组播地址。</p>
<p>•对于不支持组播的链路，OSPF支持采用单播的方式发送Hello报文。</p>
</blockquote>
<h3 id="影响邻居建立的因素"><a href="#影响邻居建立的因素" class="headerlink" title="影响邻居建立的因素"></a>影响邻居建立的因素</h3><ol>
<li><p><strong>Router ID</strong>：直连不能相同，非直连相同导致路由震荡</p>
</li>
<li><p><strong>认证</strong>：认证必须配置一致，否则不能建立邻居</p>
</li>
<li><p><strong>Area ID</strong>:必须一致，否则不能建立</p>
</li>
<li><p><strong>Hello间隔</strong>:必须一致否则不能建立</p>
<table>
<thead>
<tr>
<th></th>
<th>MA</th>
<th>P2P</th>
<th>NBMA</th>
<th>P2MP</th>
</tr>
</thead>
<tbody><tr>
<td>Hello time</td>
<td>10</td>
<td>10</td>
<td>30</td>
<td>30</td>
</tr>
<tr>
<td>Hello dead time</td>
<td>40</td>
<td>40</td>
<td>120</td>
<td>120</td>
</tr>
</tbody></table>
</li>
<li><p><strong>接口网络类型</strong>：</p>
<p>NBMA与其它网络类型不能建立起邻居关系</p>
<p>MA与P2P可以建立起来，但不能进行路由计算</p>
</li>
<li><p><strong>接口MTU值</strong>:默认不开启，ospf mtu-enable，如果不相同会卡在exstart或exchang状态。</p>
</li>
<li><p><strong>静默接口 silent-interface</strong>：接口配置成静默接口不会发送hello报文</p>
</li>
<li><p><strong>hello报文中掩码信息不一致</strong>：MA网络 不一致不能建立 P2P可以建立因为此网络类型不检查掩码信息</p>
</li>
<li><p><strong>option字段</strong>：常规区域与特殊区域不能建立邻居关系</p>
</li>
<li><p><strong>DR priority 为 0</strong>：不建立<strong>邻接</strong>关系</p>
</li>
</ol>
<h2 id="Hello报文"><a href="#Hello报文" class="headerlink" title="Hello报文"></a>Hello报文</h2><p>•Hello报文的主要作用：</p>
<p>▫邻居发现：自动发现邻居路由器。</p>
<p>▫邻居建立：完成Hello报文中的参数协商，建立邻居关系。</p>
<p>▫邻居保持：通过周期性发送和接收，检测邻居运行状态。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/19.png"></p>
<p>•<strong>重要字段解释</strong></p>
<p>​    ▫<strong>Network</strong> <strong>Mask：</strong>发送Hello报文的接口的网络掩码。</p>
<p>​    ▫<strong>HelloInterval：</strong>发送Hello报文的时间间隔。通常为10s。</p>
<p>​    ▫<strong>RouterDeadInterval：</strong>失效时间。如果在此时间内未收到邻居发来的Hello报文，则认为邻居失效。通常为40s。</p>
<p>▫<strong>Neighbor：</strong>邻居，以Router ID标识。</p>
<p>•<strong>其它字段解释</strong></p>
<p>▫<strong>Options：</strong> </p>
<p>​    ▪E：是否支持外部路由</p>
<p>​    ▪MC：是否支持转发组播数据包</p>
<p>​    ▪N/P：是否为NSSA区域</p>
<p>▫<strong>Router Priority：DR优先级。默认为1。如果设置为0，则路由器不能参与DR或BDR的选举</strong>。</p>
<p>▫<strong>Designated</strong> <strong>Router：</strong>DR的接口地址。</p>
<p>▫<strong>Backup Designated</strong> <strong>Router</strong>：BDR的接口地址。</p>
<h2 id="邻接关系建立-1"><a href="#邻接关系建立-1" class="headerlink" title="邻接关系建立 (1)"></a>邻接关系建立 (1)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/20.png"></p>
<p>•<strong>DD报文部分字段解释</strong></p>
<p>▫<strong>I</strong>：当发送连续多个DD报文时，如果这是第一个DD报文，则置为1，否则置为0。</p>
<p>▫**M (More)**：当发送连续多个DD报文时，如果这是最后一个DD报文，则置为0。否则置为1，表示后面还有其他的DD报文。</p>
<p>▫**MS (Master/Slave)**：当两台OSPF路由器交换DD报文时，首先需要确定双方的主从关系，Router ID大的一方会成为Master。当值为1时表示发送方为Master。</p>
<p>▫<strong>DD sequence</strong> <strong>number</strong>：DD报文序列号。主从双方利用序列号来保证DD报文传输的可靠性和完整性。</p>
<blockquote>
<p>•R1和R2的Router ID分别为10.0.1.1和10.0.2.2并且二者已建立了邻居关系。当R1的邻居状态变为ExStart后，R1会发送第一个DD报文。此报文中，M-bit设置为1，表示后续还有DD报文要发送，MS-bit设置为1，表示R1宣告自己为Master。DD序列号被随机设置为X，I-bit设置为1，表示这是第一个DD报文。</p>
<p>•同样当R2的邻居状态变为ExStart后，R2也会发送第一个DD报文。此报文中，DD序列号被随机设置为Y（I-bit=1，M-bit=1，MS-bit=1，含义同上）。由于R2的Router ID较大，所以R2将成为真正的Master。收到此报文后，R1会产生一个Negotiation-Done事件，并将邻居状态从ExStart变为Exchange。</p>
<p>•当R1的邻居状态变为Exchange后，R1会发送一个新的DD报文，此报文中包含了LSDB的摘要信息，序列号设置为R2在步骤2中使用的序列号Y，I-bit=0，表示这不是第一个DD报文，M-bit=0，表示这是最后一个包含LSDB摘要信息的DD报文，MS-bit=0，表示R1宣告自己为Slave。收到此报文后，R2将邻居状态从ExStart变为Exchange。</p>
<p>•当R2的邻居状态变为Exchange后，R2会发送一个新的DD报文，此报文包含了LSDB的摘要信息。DD序列号设置为Y+1, MS-bit=1，表示R2宣告自己为Master。</p>
<p>•虽然R1不需要发送新的包含LSDB摘要信息的DD报文，但是作为Slave，R1需要对Master发送的每一个DD报文进行确认。所以，R1向R2发送一个新的DD报文，序列号为Y+1，该报文内容为空。发送完此报文后，RTA产生一个Exchange-Done事件，将邻居状态变为Loading。R2收到此报文后，会将邻居状态变为Full（假设R2的LSDB是最新最全的，不需要向R1请求更新）。</p>
</blockquote>
<h2 id="DD报文"><a href="#DD报文" class="headerlink" title="DD报文"></a>DD报文</h2><p>DD报文包含LSA头部信息，包括LS Type、LS ID、Advertising Router、LS Sequence Number、LS Checksum。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/21.png"></p>
<h2 id="邻接关系建立-2"><a href="#邻接关系建立-2" class="headerlink" title="邻接关系建立 (2)"></a>邻接关系建立 (2)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/23.png"></p>
<p>•R1开始向R2发送LSR报文，请求那些在Exchange状态下通过DD报文发现的、并且在本地LSDB中没有的链路状态信息。</p>
<p>•R2向R1发送LSU报文，LSU报文中包含了那些被请求的链路状态的详细信息。R1在完成LSU报文的接收之后，且没有其他待请求的LSA后，会将邻居状态从Loading变为Full。</p>
<p>•R1向R2发送LSAck报文，作为对LSU报文的确认。</p>
<h2 id="DR与BDR的作用"><a href="#DR与BDR的作用" class="headerlink" title="DR与BDR的作用"></a>DR与BDR的作用</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/24.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/25.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/26.png"></p>
<blockquote>
<p>•MA（ Multiple Access，多路访问 ）分为BMA（ Broadcast Multi-Access，广播多路访问）和NBMA（Non-Broadcast Multiple Access，非广播多路访问）。以太网链路组成的网络是典型的BMA网络。帧中继链路通过逻辑上的划分组成典型的NBMA网络（注：帧中继相关知识不再介绍）。</p>
<p>•DRother：既不是DR也不是BDR的路由器就是DRother路由器。</p>
</blockquote>
<h2 id="DR与BDR的选举规则"><a href="#DR与BDR的选举规则" class="headerlink" title="DR与BDR的选举规则"></a>DR与BDR的选举规则</h2><p>•DR/BDR的选举是非抢占式的。</p>
<p>•DR/BDR的选举是基于接口的。</p>
<p>​    ▫接口的DR优先级越大越优先。</p>
<p>​    ▫接口的DR优先级相等时，Router ID越大越优先。</p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/28.png"></p>
<p>•思考：</p>
<p>▫如果将上图中4台路由器的优先级全部设置为0，OSPF是否可以正常工作？</p>
<p>▫缺省情况下，哪些链路类型组成的网络是MA网络呢？</p>
<blockquote>
<p>广播链路或者NBMA链路上DR和BDR的选举过程如下：</p>
<p>▫接口UP后，发送Hello报文，同时进入到Waiting状态。在Waiting状态下会有一个WaitingTimer，该计时器的长度与DeadTimer是一样的。默认值为40秒，用户不可自行调整。</p>
<p>▫在WaitingTimer触发前，发送的Hello报文是没有DR和BDR字段的。在Waiting阶段，如果收到Hello报文中有DR和BDR，那么直接承认网络中的DR和BDR，而不会触发选举。直接离开Waiting状态，开始邻居同步。</p>
<p>▫假设网络中已经存在一个DR和一个BDR，这时新加入网络中的路由器，不论它的Router ID或者DR优先级有多大，都会承认现网中已有的DR和BDR。</p>
<p>▫当DR因为故障Down掉之后，BDR会继承DR的位置，剩下的优先级大于0的路由器会竞争成为新的BDR。</p>
<p>▫只有当不同Router ID，或者配置不同DR优先级的路由器同时起来，在同一时刻进行DR选举才会应用DR选举规则产生DR。</p>
</blockquote>
<h2 id="不同网络类型中DR与BDR的选举操作"><a href="#不同网络类型中DR与BDR的选举操作" class="headerlink" title="不同网络类型中DR与BDR的选举操作"></a>不同网络类型中DR与BDR的选举操作</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/29.png"></p>
<h2 id="可按需调整设备接口的OSPF网络类型"><a href="#可按需调整设备接口的OSPF网络类型" class="headerlink" title="可按需调整设备接口的OSPF网络类型"></a>可按需调整设备接口的OSPF网络类型</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/30.png"></p>
<p>•OSPF的网络类型是根据接口的数据链路层封装自动设置的。</p>
<p>•图中的路由器采用以太网接口互联，因此这些接口的网络类型缺省均为Broadcast。</p>
<p>•每段链路实际上都是点对点链路，因此在链路上选举DR与BDR是没有必要的。</p>
<p>•为了提高OSPF的工作效率，加快邻接关系的建立过程，可以把这些互联接口的网络类型都修改为P2P。</p>
<blockquote>
<p>•OSPF的网络类型是协议根据接口的数据链路层封装自动设置的，在图中，两台处于网络接入层的路由器AS-R1及AS-R2都通过双链路上联到核心层的路由器CO-R1及CO-R2。四台路由器都在各自接口上激活OSPF。由于这些路由器都是采用以太网接口互联，因此这些接口的网络类型缺省均为Broadcast，于是在邻居关系的建立过程中，OSPF会在每段以太网链路上选举DR及BDR。</p>
<p>•然而，这实际上是没有必要而且浪费时间的（DR及BDR的选举过程涉及一个等待计时器，这增加了直连路由器形成邻接关系的时间），因为这些链路其实从逻辑的角度看都是点对点的连接，选举DR或BDR实在是画蛇添足。因此为了提高OSPF的工作效率，加快邻接关系的建立过程，可以把这些互联接口的网络类型都修改为P2P。</p>
</blockquote>
<h1 id="OSPF的基本配置"><a href="#OSPF的基本配置" class="headerlink" title="OSPF的基本配置"></a>OSPF的基本配置</h1><h2 id="配置命令介绍-1"><a href="#配置命令介绍-1" class="headerlink" title="配置命令介绍 (1)"></a>配置命令介绍 (1)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/31.png"></p>
<blockquote>
<p>•缺省情况下，OSPF以32位主机路由的方式对外发布Loopback接口的IP地址，与Loopback接口上配置的掩码长度无关。如果要发布Loopback接口的实际网段，需要在接口下配置网络类型为NBMA或广播型。</p>
</blockquote>
<h2 id="配置命令介绍-2"><a href="#配置命令介绍-2" class="headerlink" title="配置命令介绍 (2)"></a>配置命令介绍 (2)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/32.png"></p>
<h2 id="OSPF配置举例"><a href="#OSPF配置举例" class="headerlink" title="OSPF配置举例"></a>OSPF配置举例</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/33.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/34.png"></p>
<h2 id="OSPF配置验证-1"><a href="#OSPF配置验证-1" class="headerlink" title="OSPF配置验证 (1)"></a>OSPF配置验证 (1)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/35.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/36.png"></p>
<h2 id="OSPF配置验证-2"><a href="#OSPF配置验证-2" class="headerlink" title="OSPF配置验证 (2)"></a>OSPF配置验证 (2)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/37.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/38.png"></p>
<h2 id="OSPF配置验证-3"><a href="#OSPF配置验证-3" class="headerlink" title="OSPF配置验证 (3)"></a>OSPF配置验证 (3)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/39.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/40.png"></p>
<h2 id="OSPF配置验证-4"><a href="#OSPF配置验证-4" class="headerlink" title="OSPF配置验证 (4)"></a>OSPF配置验证 (4)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/41.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/42.png"></p>
<h2 id="OSPF配置验证-5"><a href="#OSPF配置验证-5" class="headerlink" title="OSPF配置验证 (5)"></a>OSPF配置验证 (5)</h2><p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/43.png"></p>
<p><img src="/2021/05/06/OSPF%E5%9F%BA%E7%A1%80/44.png"></p>
<h1 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h1><p>1.（单选题）OSPF使用以下哪种报文维护邻居关系？（   ）</p>
<p><strong>A.Hello</strong></p>
<p>B.Database Description</p>
<p>C.LSR</p>
<p>D.LSU</p>
<p>2.（多选题）OSPF支持以下哪些网络类型？（   ）</p>
<p><strong>A.P2P网络</strong></p>
<p><strong>B.P2MP网络</strong></p>
<p><strong>C.广播网络</strong></p>
<p><strong>D.NBMA网络</strong></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>•本文简单介绍了OSPF的基本概念，内容包括Router ID、区域、Cost。运行OSPF的路由器通过相互发送链路状态信息完成拓扑和路由计算。</p>
<p>•本文详细介绍了OSPF邻居和邻接关系建立的过程。在MA网络中，需要选举DR和BDR。OSPF有5种类型的报文，所有报文有相同的报文头部格式。运行OSPF的路由器通过周期性的发送Hello报文发现和维持邻居关系，通过DD、LSR、LSU、LSAck报文配合完成链路状态数据库的同步。最后介绍了OSPF单区域的简单配置。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/IP-3-OSPF%E5%9F%BA%E7%A1%80/" rel="tag"># IP-3-OSPF基础</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/05/06/IP%E8%B7%AF%E7%94%B1%E5%9F%BA%E7%A1%80/" rel="next" title="IP-IP路由基础">
                <i class="fa fa-chevron-left"></i> IP-IP路由基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/05/09/OSPF%E8%B7%AF%E7%94%B1%E8%AE%A1%E7%AE%97/" rel="prev" title="OSPF路由计算">
                OSPF路由计算 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/mydog.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">56</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zsy9959" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:zsy9959@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B"><span class="nav-number">3.</span> <span class="nav-text">动态路由协议简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">3.1.</span> <span class="nav-text">动态路由协议的分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%9D%E7%A6%BB%E7%9F%A2%E9%87%8F%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.2.</span> <span class="nav-text">距离矢量路由协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-LSA%E6%B3%9B%E6%B4%AA"><span class="nav-number">3.3.</span> <span class="nav-text">链路状态路由协议 - LSA泛洪</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-LSDB%E7%BB%B4%E6%8A%A4"><span class="nav-number">3.4.</span> <span class="nav-text">链路状态路由协议 - LSDB维护</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-SPF%E8%AE%A1%E7%AE%97"><span class="nav-number">3.5.</span> <span class="nav-text">链路状态路由协议 - SPF计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-%E8%B7%AF%E7%94%B1%E8%A1%A8%E7%94%9F%E6%88%90"><span class="nav-number">3.6.</span> <span class="nav-text">链路状态路由协议 - 路由表生成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93"><span class="nav-number">3.7.</span> <span class="nav-text">链路状态路由协议总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OSPF%E7%AE%80%E4%BB%8B"><span class="nav-number">4.</span> <span class="nav-text">OSPF简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E6%A6%82%E8%BF%B0"><span class="nav-number">4.1.</span> <span class="nav-text">OSPF概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">4.2.</span> <span class="nav-text">OSPF应用场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%9F%BA%E7%A1%80%E6%9C%AF%E8%AF%AD-Router-ID"><span class="nav-number">4.3.</span> <span class="nav-text">OSPF基础术语 - Router ID</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%9F%BA%E7%A1%80%E6%9C%AF%E8%AF%AD-%E5%8C%BA%E5%9F%9F"><span class="nav-number">4.4.</span> <span class="nav-text">OSPF基础术语 - 区域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%9F%BA%E7%A1%80%E6%9C%AF%E8%AF%AD-%E5%BA%A6%E9%87%8F%E5%80%BC"><span class="nav-number">4.5.</span> <span class="nav-text">OSPF基础术语 - 度量值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%9F%BA%E7%A1%80%E6%9C%AF%E8%AF%AD-%E5%BA%A6%E9%87%8F%E5%80%BC%E4%BF%AE%E6%94%B9%E4%B8%BE%E4%BE%8B"><span class="nav-number">4.6.</span> <span class="nav-text">OSPF基础术语 - 度量值修改举例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E4%B8%89%E5%A4%A7%E8%A1%A8%E9%A1%B9-%E9%82%BB%E5%B1%85%E8%A1%A8"><span class="nav-number">4.7.</span> <span class="nav-text">OSPF三大表项 - 邻居表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E4%B8%89%E5%A4%A7%E8%A1%A8%E9%A1%B9-LSDB"><span class="nav-number">4.8.</span> <span class="nav-text">OSPF三大表项 - LSDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E4%B8%89%E5%A4%A7%E8%A1%A8%E9%A1%B9-OSPF%E8%B7%AF%E7%94%B1%E8%A1%A8"><span class="nav-number">4.9.</span> <span class="nav-text">OSPF三大表项 - OSPF路由表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F%E5%92%8C%E7%B1%BB%E5%9E%8B"><span class="nav-number">4.10.</span> <span class="nav-text">OSPF报文格式和类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OSPF%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="nav-number">5.</span> <span class="nav-text">OSPF工作过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B%E6%A6%82%E8%A7%88"><span class="nav-number">5.1.</span> <span class="nav-text">OSPF工作过程概览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E9%82%BB%E5%B1%85%E5%85%B3%E7%B3%BB"><span class="nav-number">5.2.</span> <span class="nav-text">建立邻居关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E9%82%BB%E5%B1%85%E5%BB%BA%E7%AB%8B%E7%9A%84%E5%9B%A0%E7%B4%A0"><span class="nav-number">5.2.1.</span> <span class="nav-text">影响邻居建立的因素</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hello%E6%8A%A5%E6%96%87"><span class="nav-number">5.3.</span> <span class="nav-text">Hello报文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%82%BB%E6%8E%A5%E5%85%B3%E7%B3%BB%E5%BB%BA%E7%AB%8B-1"><span class="nav-number">5.4.</span> <span class="nav-text">邻接关系建立 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DD%E6%8A%A5%E6%96%87"><span class="nav-number">5.5.</span> <span class="nav-text">DD报文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%82%BB%E6%8E%A5%E5%85%B3%E7%B3%BB%E5%BB%BA%E7%AB%8B-2"><span class="nav-number">5.6.</span> <span class="nav-text">邻接关系建立 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DR%E4%B8%8EBDR%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">5.7.</span> <span class="nav-text">DR与BDR的作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DR%E4%B8%8EBDR%E7%9A%84%E9%80%89%E4%B8%BE%E8%A7%84%E5%88%99"><span class="nav-number">5.8.</span> <span class="nav-text">DR与BDR的选举规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E7%BD%91%E7%BB%9C%E7%B1%BB%E5%9E%8B%E4%B8%ADDR%E4%B8%8EBDR%E7%9A%84%E9%80%89%E4%B8%BE%E6%93%8D%E4%BD%9C"><span class="nav-number">5.9.</span> <span class="nav-text">不同网络类型中DR与BDR的选举操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E6%8C%89%E9%9C%80%E8%B0%83%E6%95%B4%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%8F%A3%E7%9A%84OSPF%E7%BD%91%E7%BB%9C%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.10.</span> <span class="nav-text">可按需调整设备接口的OSPF网络类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OSPF%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="nav-number">6.</span> <span class="nav-text">OSPF的基本配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D-1"><span class="nav-number">6.1.</span> <span class="nav-text">配置命令介绍 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D-2"><span class="nav-number">6.2.</span> <span class="nav-text">配置命令介绍 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E4%B8%BE%E4%BE%8B"><span class="nav-number">6.3.</span> <span class="nav-text">OSPF配置举例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81-1"><span class="nav-number">6.4.</span> <span class="nav-text">OSPF配置验证 (1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81-2"><span class="nav-number">6.5.</span> <span class="nav-text">OSPF配置验证 (2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81-3"><span class="nav-number">6.6.</span> <span class="nav-text">OSPF配置验证 (3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81-4"><span class="nav-number">6.7.</span> <span class="nav-text">OSPF配置验证 (4)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSPF%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81-5"><span class="nav-number">6.8.</span> <span class="nav-text">OSPF配置验证 (5)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%9D%E8%80%83"><span class="nav-number">7.</span> <span class="nav-text">思考</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张思宇</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
