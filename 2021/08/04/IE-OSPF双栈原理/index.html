<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="HCRSE-104-OSPF双栈原理," />










<meta name="description" content="LSA头部信息，除Hello报文外，其它的OSPF报文都携带LSA信息。  LS age：此字段表示LSA已经生存的时间，单位是秒。 Option：该字段指出了部分OSPF域中LSA能够支持的可选性能。 LS type：此字段标识了LSA的格式和功能。常用的LSA类型有五种。 Link State ID：根据LSA的不用而不同。 Advertising Router：始发LSA的路由">
<meta property="og:type" content="article">
<meta property="og:title" content="IE-OSPF双栈原理">
<meta property="og:url" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/index.html">
<meta property="og:site_name" content="zsy&#39;s blog">
<meta property="og:description" content="LSA头部信息，除Hello报文外，其它的OSPF报文都携带LSA信息。  LS age：此字段表示LSA已经生存的时间，单位是秒。 Option：该字段指出了部分OSPF域中LSA能够支持的可选性能。 LS type：此字段标识了LSA的格式和功能。常用的LSA类型有五种。 Link State ID：根据LSA的不用而不同。 Advertising Router：始发LSA的路由">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/1.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/2.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/3.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/4.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/5.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/7.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/8.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/9.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/11.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/12.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/13.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/14.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/15.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/16.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/17.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/18.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/19.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/20.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/21.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/22.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/23.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/24.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/25.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/26.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/27.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/28.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/29.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/30.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/31.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/32.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/33.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/34.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/35.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/36.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/37.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/38.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/39.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/40.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/41.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/42.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/43.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/44.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/45.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/46.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/47.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/48.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/49.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/50.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/51.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/52.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/53.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/54.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/55.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/56.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/57.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/58.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/59.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/60.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/61.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/62.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/63.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/64.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/65.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/66.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/67.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/68.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/69.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/70.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/71.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/72.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/73.png">
<meta property="og:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/74.png">
<meta property="article:published_time" content="2021-08-04T06:54:19.000Z">
<meta property="article:modified_time" content="2021-08-04T12:08:12.430Z">
<meta property="article:author" content="张思宇">
<meta property="article:tag" content="HCRSE-104-OSPF双栈原理">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2021/08/04/IE-OSPF双栈原理/"/>





  <title>IE-OSPF双栈原理 | zsy's blog</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zsy's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">just simple</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/home" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mydog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zsy's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">IE-OSPF双栈原理</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-04T14:54:19+08:00">
                2021-08-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/1.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/2.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/3.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/4.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/5.png"></p>
<blockquote>
<ul>
<li><p>LSA头部信息，除Hello报文外，其它的OSPF报文都携带LSA信息。</p>
<ul>
<li>LS age：此字段表示LSA已经生存的时间，单位是秒。</li>
<li>Option：该字段指出了部分OSPF域中LSA能够支持的可选性能。</li>
<li>LS type：此字段标识了LSA的格式和功能。常用的LSA类型有五种。</li>
<li>Link State ID：根据LSA的不用而不同。</li>
<li>Advertising Router：始发LSA的路由器的ID。</li>
<li>Sequence Number：当LSA每次新的实例产生时，这个序列号就会增加。这个更新可以帮助其他路由器识别最新的LSA实例。</li>
<li>Checksum：关于LSA的全部信息的校验和。因为Age字段，所以校验和会随着老化时间的增大而每次都需要重新进行计算。</li>
<li>Length：是一个包含LSA头部在内的LSA的长度。</li>
</ul>
</li>
<li><p>Router-LSA，Router-LSA必须描述始发路由器所有接口或链路。</p>
<ul>
<li>Link State ID：是指始发路由器的路由器ID。</li>
<li>Flag：<ul>
<li>V：设置为1时，说明始发路由器是一条或者多条具有完全邻接关系的虚链路的一个端点。</li>
<li>E：当始发路由器是一个ASBR路由器时，该为置为1。</li>
<li>B：当始发路由器是一个ABR路由器时，该为置为1。</li>
</ul>
</li>
<li>Number of links：表明一个LSA所描述的路由器链路数量。</li>
<li>Link Type：<ul>
<li>值为1表示为点到点网络，常见的PPP链路需要使用点到点网络描述。</li>
<li>值为2表示连接一个transit网络，有至少两台路由器的广播型网段或NBMA网段就是一种Transit网段。</li>
<li>值为3表示连接stubnet网络，一般该网络上不存在邻居关系，如只有一个出口的以太网或回环接口。</li>
<li>值为4表示虚链路。</li>
</ul>
</li>
<li>Link ID：<ul>
<li>Link Type为1时该值表示邻居路由器的路由器ID。</li>
<li>Link Type为2时该值表示DR路由器的接口的IP地址。</li>
<li>Link Type为3时该值表示IP网络或子网地址。</li>
<li>Link Type为4时该值表示邻居路由器的路由器ID。</li>
</ul>
</li>
<li>Link Data：<ul>
<li>Link Type为1时该值表示和网络相连的始发路由器接口的IP地址。</li>
<li>Link Type为2时该值表示和网络相连的始发路由器接口的IP地址。</li>
<li>Link Type为3时该值表示网络的子网掩码。</li>
<li>Link Type为4时该值表示始发路由器的虚链路接口的IP地址。</li>
</ul>
</li>
<li>ToS，暂不支持。</li>
<li>Metric：是指一条链路或接口的代价。</li>
</ul>
</li>
<li><p>Network-LSA</p>
<ul>
<li>Link State ID：是指DR路由器的接口地址。</li>
<li>Network Mask：指定这个网络上使用的地址或者子网的掩码。</li>
<li>Attached router：列出该多路访问网络上与DR形成完全邻接关系且包括DR本身的所有路由器的路由器ID。</li>
</ul>
</li>
<li><p>Network-summary-LSA和ASBR-summary-LSA</p>
<ul>
<li>Link State ID：对于3类LSA来说，表示所通告的网络或子网的IP地址。对于4类LSA来说表示所通告的ASBR路由器的路由器ID。</li>
<li>Network Mask：对于3类LSA来说，表示所通告的网络的子网掩码。对于4类LSA来说，该字段没有实际意义，一般置为0.0.0.0。</li>
<li>Metric：始发路由器到目的地址的路由的代价。</li>
</ul>
</li>
<li><p>AS-external-LSA</p>
<ul>
<li>Link State ID：表示所通告的网络或子网的IP地址。</li>
<li>Network Mask:指所通告的网络的子网掩码。</li>
<li>E：用来指定这条路由使用的外部度量的类型。如果该E bit设置为1,那么度量类型就是E2;如果该E bit设置为0,那么度量类型就是E1。</li>
<li>Metric：指路由的代价。由ASBR设定。</li>
<li>Forwarding Address：是指到达所通告的目的地的数据包应该被转发到的地址。如果转发地址是0.0.0.0,那么数据包将被转发到始发ASBR上。</li>
<li>External Route Tag:标记外部路由。</li>
</ul>
</li>
<li><p>NSSA LSA</p>
<ul>
<li>Forwarding Address：如果所引入外部路由的下一跳在OSPF路由域内，则Forwarding Address直接设置为所引入外部路由的下一跳；如果所引入外部路由的下一跳不在OSPF路由域内，则Forwarding Address设置为该ASBR上某个OSPF路由域内的Stub网段（例如Loopback0接口）的接口IP地址，有多个Stub网段时选IP地址最大者。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/7.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/8.png"></p>
<blockquote>
<ul>
<li>Option字段解释：<ul>
<li>DN：用来避免在MPLS VPN中出现环路。当PE向CE发送3类、5类和7类LSA时需要设置DN位，其他PE路由器从CE接收到该LSA时，不能够在它的OSPF路由计算中使用该LSA。</li>
<li>O：该字段指出始发路由器支持Opaque LSA（类型9、类型10和类型11）。</li>
<li>DC位：当始发路由器支持按需链路上的OSPF的能力时，该位将被设置。</li>
<li>EA：当始发路由器具有接收和转发External-Attributes-LSA（type8 LSA）的能力时，该位被置位。</li>
<li>N位：只用在Hello数据包中。N=1表明路由器支持7类LSA。N=0表明该路由器将不接收和发送NSSA LSA。</li>
<li>P位：只用在NSSA LSA。该位将告诉NSSA区域的ABR路由器将7类LSA转换为5类LSA。</li>
<li>MC位：当始发路由器支持转发组播数据包的能力时，该位将被置位。</li>
<li>E位：当始发路由器具有接收AS-external-LSA（type5 LSA）的能力时，该位被置位。在所有5类LSA和始发于骨干区域以及非末节区域的LSA中，该位置为1。而始发于末节区域的LSA中，该位置为0。如果Hello报文中该位被置位则表明该接口具有接收和发送5类LSA的能力。</li>
<li>MT位：表示始发路由器支持多拓扑OSPF。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/9.png"></p>
<blockquote>
<ul>
<li><p>快速收敛：</p>
<ul>
<li>I-SPF改进了这个算法，除了第一次计算时需要计算全部节点外，每次只计算受到影响的节点，而最后生成的最短路径树SPT与原来的算法所计算的结果相同，大大降低了CPU的占用率，提高了网络收敛速度。</li>
<li>PRC的原理与I-SPF相同，都是只对发生变化的路由进行重新计算。不同的是，PRC不需要计算节点路径，而是根据I-SPF算出来的SPT来更新路由。在路由计算中，叶子代表路由，节点则代表路由器。SPT变化和叶子变化都会引起路由信息的变化，但两者不存在依赖关系，PRC根据SPT或叶子的不同情况进行相应的处理：<ul>
<li>SPT变化，PRC处理变化节点上的所有叶子的路由信息。</li>
<li>SPT没有变化，PRC不会处理节点的路由信息。</li>
<li>叶子变化，PRC处理变化的叶子的路由信息。</li>
<li>叶子没有变化，PRC不会处理叶子的路由信息。</li>
</ul>
</li>
</ul>
</li>
<li><p>智能定时器，OSPF智能定时器分别对路由计算、LSA的产生、LSA的接收进行控制，加速网络收敛。OSPF智能定时器可以通过以下两种方式来加速网络收敛：</p>
<ul>
<li><p>在频繁进行路由计算的网络中，OSPF智能定时器根据用户的配置和指数衰减技术动态调整两次路由计算的时间间隔，减少路由计算的次数，从而减少CPU的消耗，待网络拓扑稳定后再进行路由计算。</p>
</li>
<li><p>在不稳定网络中，当路由器由于拓扑的频繁变化需要产生或接收LSA时，OSPF智能定时器可以动态调整时间间隔，在时间间隔之内不产生LSA或对接受到的LSA不进行处理，从而减少整个网络无效LSA的产生和传播。</p>
</li>
<li><p>智能定时器对路径计算的作用：</p>
<ul>
<li><p>根据本地维护的链路状态数据库LSDB，运行OSPF协议的路由器通过SPF算法计算出以自己为根的最短路径树，并根据这一最短路径树决定到目的网络的下一跳。通过调节SPF的计算间隔，可以抑制网络频繁变化可能导致的占用过多带宽资源和路由器资源。</p>
</li>
<li><p>在特定组网环境下（例如对路由收敛时间要求较高的环境），可以指定以毫秒为单位的时间间隔，用来增加路由计算的频度，从而加快路由的收敛。</p>
</li>
<li><p>当OSPF的链路状态数据库（LSDB）发生改变时，需要重新计算最短路径。如果网络频繁变化，由于不断的计算最短路径，会占用大量系统资源，影响路由器的效率。通过配置智能定时器，设置合理的SPF计算的间隔时间，可以避免占用过多的路由器内存和带宽资源。</p>
</li>
<li><p>使能智能定时器后：</p>
<p>​    初次计算SPF的间隔时间由start-interval参数指定。</p>
<p>​    第n（n≥2）次计算SPF的间隔时间为hold-interval×2(n-1)。</p>
<p>当hold-interval×2(n-1)达到指定的最长间隔时间max-interval时，OSPF连续三次计算SPF的时间间隔都是最长间隔时间，之后，再次返回步骤1，按照初始间隔时间start-interval计算SPF。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>按优先级收敛：</p>
<ul>
<li>可以通过IP前缀列表等将特定路由过滤出来，通过对不同的路由配置不同的收敛优先级，达到重要的路由先收敛的目的，提高网络的可靠性。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/11.png"></p>
<blockquote>
<ul>
<li><p>通过设置路由器上非缺省外部路由数量的上限，来避免数据库超限。OSPF网络中所有路由器都必须配置相同的上限值。这样，只要路由器上外部路由的数量达到该上限，路由器就进入Overflow状态，并同时启动超限状态定时器（默认超时时间为5秒），路由器在定时器超过5秒后自动退出超限状态。</p>
</li>
<li><p>OSPF Database Overflow过程：</p>
<ul>
<li>进入Overflow状态时，路由器删除所有自己产生的非缺省外部路由。</li>
<li>处于Overflow状态中时，路由器不产生非缺省外部路由；丢弃新收到的非缺省外部路由且不回复确认报文；当超限状态定时器超时，检查外部路由数量是否仍然超过上限，如果超限则重启定时器，如果没有则退出超限状态。</li>
<li>退出Overflow状态时，路由器删除超限状态定时器；产生非缺省外部路由；接收新收到的非缺省外部路由并回复确认报文；准备下一次进入超限状态。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/12.png"></p>
<blockquote>
<ul>
<li><p>OSPF 缺省路由通常应用于下面两种情况：</p>
<ul>
<li>由区域边界路由器（ABR）发布 Type3 缺省 Summary LSA，用来指导区域内设备进行区域之间报文的转发。</li>
<li>由自治系统边界路由器（ASBR）发布 Type5 外部缺省 ASE LSA，或者 Type7 外部缺省NSSA LSA，用来指导自治系统（AS）内设备进行自治系统外报文的转发。</li>
</ul>
</li>
<li><p>OSPF 缺省路由的发布原则如下：</p>
<ul>
<li>OSPF 路由器只有具有对外的出口时，才能够发布缺省路由 LSA。</li>
<li>如果 OSPF 路由器已经发布了缺省路由 LSA，那么不再学习其它路由器发布的相同类型缺省路由。即路由计算时不再计算其它路由器发布的相同类型的缺省路由 LSA，但数据库中存有对应 LSA。</li>
<li>外部缺省路由的发布如果要依赖于其它路由，那么被依赖的路由不能是本 OSPF 路由域内的路由，即不是本进程 OSPF 学习到的路由。因为外部缺省路由的作用是用于指导报文的域外转发，而本 OSPF 路由域的路由的下一跳都指向了域内，不能满足指导报文域外转发的要求。 </li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/13.png"></p>
<blockquote>
<ul>
<li><p>OSPF 支持使用路由策略对路由信息进行过滤。缺省情况下， OSPF 不进行路由过滤。</p>
</li>
<li><p>OSPF 可以使用的路由策略包括 route-policy，filter，filter-policy，filter-lsa-out，访问控制列表（access-list），地址前缀列表（prefix-list）。 </p>
</li>
<li><p>OSPF 路由过滤可以应用于以下几个方面： </p>
<ul>
<li>路由引入的过滤：<ul>
<li>OSPF可以引入其它路由协议学习到的路由。在引入时可以通过配置路由策略来过滤路由，只引入满足条件的路由。</li>
<li>可以在OSPF 路由表中被发布出去</li>
</ul>
</li>
<li>3类LSA学习、发布的过滤：<ul>
<li>通过filter import、filter export命令在 ABR上对进入或离开本区域的3型LSA 进行过滤。该配置只在ABR上有效（只有ABR才能发布3型LSA）。 </li>
<li>5、7类LSA生成的过滤：</li>
<li>OSPF 引入外部路由后会生成5、7型LSA。可以通过filter-policy export来对5、7型LSA的生成进行过滤。该过滤规则只在 ASBR 上配置才有效。</li>
</ul>
</li>
</ul>
</li>
<li><p>接口视图下的LSA过滤。通过ospf filter-lsa-out命令， 匹配除Grace LSA外的所有LSA、3、5、7型LSA，并匹配ACL规定的路由前缀时，实现LSA的通告过滤。</p>
</li>
<li><p>路由计算的过滤：</p>
<ul>
<li>通过filter-policy import过滤规则，可以设置 OSPF对数据库中的区域内、区域间、外部LSA计算为路由条目时进行过滤。<br> 该过滤只作用于路由表项的添加与否，即只有通过过滤的路由才被添加到本地路由表中，产生该路由的LSA仍然会在OSPF自治系统内扩散。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/14.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/15.png"></p>
<blockquote>
<ul>
<li>相关解释如下：<ul>
<li>OSPF支持的网络类型有P2P网络、P2MP网络、NBMA网络和广播网络；IS-IS仅支持P2P网络和广播网络。</li>
<li>OSPF工作在IP之上，协议号为89。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/16.png"></p>
<blockquote>
<ul>
<li>相关解释如下：<ul>
<li>OSPF建立邻居需要检查Hello报文中的掩码、认证、hello/dead时间间隔、区域等信息。而IS-IS形成邻居关系条件比较宽松。</li>
<li>OSPF P2P链路建立邻居关系需要三次握手。IS-IS则不要三次握手，但是华为设备缺省情况下使能IS-IS P2P网络三次握手功能，以保证邻居建立的可靠性。</li>
<li>IS-IS邻居关系分为层1和层2。</li>
<li>OSPF依据优先级和router-id选举DR/BDR，且选举结束后，不可抢占。在OSPF中，所有DRother与DR/BDR形成完全邻接关系，DRother间形成2-way即不完全邻接关系。OSPF中，如果优先级为0，则表示该路由器不参与DR/BDR选举。</li>
<li>IS-IS选举DIS依据优先级和MAC地址，可以抢占。在IS-IS中，所有路由器均形成邻接关系。IS-IS中，如果优先级为0，则表示该路由器也会参与DIS选举，只是优先级比较低。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/17.png"></p>
<blockquote>
<ul>
<li>相关解释如下：<ul>
<li>IS-IS LSP种类较少，但是扩展性较强，主要通过LSP携带的TLV字段进行功能扩展。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/18.png"></p>
<blockquote>
<ul>
<li>相关解释如下：<ul>
<li>OSPF开销是基于带宽的；IS-IS理论上开销类型分为四种，包括缺省开销、时延开销、代价开销、差错开销，但在实现上只采用缺省开销。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/19.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/20.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/21.png"></p>
<blockquote>
<p>默认情况下，OSPF不检查DD报文中的MTU。</p>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/22.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/23.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/24.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/25.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/26.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/27.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/28.png"></p>
<blockquote>
<ul>
<li>IPv6中重点强调了一个“链路（link）”的概念，在IPv6中，一个链路上可以分配多个IP子网，也就是IPv6前缀。和IPv4中不同的是，同一个链路上的两个节点即使不具有相同的IPv6前缀，也可以直接通过这个链路通信。这一点极大地改变了OSPF的行为。</li>
<li>OSPFv3是基于链路运行的，而不是以前的基于IP子网的运行。在OSPFv3中我们更多的是使用“链路”和“前缀”这两个术语。但这两个概念是分离的，没有必然的对应关系。同一链路上的两个节点不必具有相同的前缀。所以在讨论路由协议时，OSPFv2的术语“网络”和“子网”在这里应该用“链路”替换掉。同样，一个OSPF接口现在是连接到一个链路上，而不再是一个IP子网上了。OSPF协议分组的接收以及Hello分组和LSA的格式也因此做出了相应的修改。</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/29.png"></p>
<blockquote>
<ul>
<li><p>一个路由器可以学习到这个链路上相连的所有其它路由器的链路本地地址，并使用这些链路本地地址作为下一跳来转发报文。</p>
</li>
<li><p>IPv6在RFC2373中定义了链路本地（link-local）地址用于一个单一链路上，其目的是完成邻居发现（neighbor discovery）和自动配置（auto-configuration）等功能。IPv6路由器不转发源地址为link-local类型的分组。Link-local单播地址范围为IPv6地址范围FE80/10。</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/30.png"></p>
<blockquote>
<ul>
<li><p>Router A、 Router B、 Router C和Router D连接到同一个广播网上，它们共享同一条链路且都能建立邻居关系，通过在Router A的Eth1/1、 Router B的Eth1/1、Router C的Eth1/2上指定实例1、在Router A的Eth1/1、 Router B的Eth1/1、 RouterD的Eth1/3上指定实例2，实现了Router A、 Router B和Router C可以建立邻居关系， Router A、 Router B和Router D可以建立邻居关系。</p>
</li>
<li><p>这是通过在OSPFv3报文头中添加Instance ID字段来实现的。如果接口配置的Instance ID与接收的OSPF v3报文的Instance ID不匹配，则丢弃该报文，从而无法建立起邻居关系。</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/31.png"></p>
<blockquote>
<ul>
<li>OSPFv3协议一般自身不再提供认证功能，而是通过使用IPv6提供的安全机制来保证自身报文的合法性。所以， OSPFv2报文中的认证字段，在OSPFv3报文头中被取消。 </li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/32.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/33.png"></p>
<blockquote>
<ul>
<li><p>与OSPFv2一样， OSPFv3的五种报文都有同样的报文头，只是报文中的字段有些不同。</p>
</li>
<li><p>OSPFv3的LSU和LSAck报文与OSPFv2相比没有什么变化，但OSPFv3的报文头、 Hello、 DD以及LSR报文中的字段与OSPFv2略有不同，报文的改变包括以下几点：</p>
<ul>
<li>版本号从 2 升级到 3。</li>
<li>报文头的不同：与 OSPFv2 报文头相比， OSPFv3 报文头长度只有 16 字节，去掉了认证字段但加了 Instance ID 字段。 Instance ID 字段用来支持在同一条链路上运行多个实例，且只在链路本地范围内有效，如果路由器接收到的 Hello 报文的 Instance ID 与当前接口配置的 Instance ID 不同，将无法建立邻居关系。 </li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/34.png"></p>
<blockquote>
<ul>
<li><p>Hello 报文的不同：与 OSPFv2 Hello 报文相比， OSPFv3 Hello 报文去掉了网络掩码字段，增加了 Interface ID 字， 用来标识发送该 Hello 报文的接口ID。 </p>
</li>
<li><p>Instance ID:  4字节。报文发送者的发送接口标识，仅用来区分同一路由器上的不同接口，不包含地址信息。</p>
</li>
<li><p>Rtr Pri:  1字节。路由器优先级，优先级高者成为DR。</p>
</li>
<li><p>Options: 3字节。 OSPFv3中将Options字段扩展为24位。</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/35.png"></p>
<blockquote>
<ul>
<li><p>在OSPFv2中， Option字段出现在每一个Hello报文、 DD报文以及每一个LSA中。</p>
</li>
<li><p>在 OSPFv3中， Option字段只在 Hello报文、 DD报文、 Router LSA、 Network LSA、 Inter Area Router LSA以及Link LSA中出现。 </p>
</li>
<li><p>从上图可以看出，与OSPFv2相比， OSPFv3的Option字段增加了R比特、 V比特。</p>
<ul>
<li>R 比特：用来标识设备是否是具备转发能力的路由器。如果 R 比特置 0，宣告该节点的路由信息将不会参加路由计算，如果当前设备是一个不想转发非本地地址的报文，可以将 R 比特置 0。</li>
<li>V6 比特：如果 V6 比特置 0，该路由器或链路也不会参加IPv6路由计算。</li>
<li>E: 如果为0，不支持AS-External-LSA洪泛；</li>
<li>MC: 与多播相关；</li>
<li>N: 是否在NSSA (Not So Stub Area)区域；</li>
<li>DC: 是否支持按需拨号。</li>
</ul>
</li>
<li><p>Options字段的各位的匹配情况会产生不同影响：</p>
<ul>
<li>阻止邻居的建立，例如Hello报文中的选项不匹配。</li>
<li>阻止LSA的洪泛，例如E-Bit，如果为0，不洪泛AS-External-LSA。</li>
<li>阻止LSA参加路由计算，例如V6-Bit，如果为0，该Router不参加IPv6路由计算。</li>
<li>Options字段使OSPF路由器能支持可选的能力，并且与其它路由器互相通告其能力。通过这种机制，具有不同能力的路由器可以在一个OSPF路由域中混合工作。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/36.png"></p>
<blockquote>
<ul>
<li>OSPFv2中的LS Type长度为8比特，指定LSA的类型； OSPFv3的LSA Type字段由OSPFv2的8比特扩充为16比特。<ul>
<li>U 位：描述了路由器收到一个类型未知的 LSA 时如何处理，取值为 0 表示把类型未知 LSA 当成具有链路本地范围的 LSA 一样处理，取值为 1 表示按照S2/S1 位标识的泛洪范围来处理。 </li>
<li>S2/S1 位：共同标识 LSA 的泛洪范围，取值 00 表示 LSA 只在产生该 LSA 的本地链路上泛洪；取值 01 表示 LSA 的泛洪范围为产生该 LSA 的路由器所在区域；取值 10 表示 LSA 将在整个自治系统内进行泛洪；取值 11 保留。</li>
<li>LSA Function Code： LSA 类型编码，描述 LSA 的类型。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/37.png"></p>
<blockquote>
<ul>
<li><p>在OSPFv2中，收到类型未知的LSA将直接丢弃。 </p>
</li>
<li><p>OSPFv3在LSA的LS Type字段中增加了一个U比特位来位标识对未知类型LSA的处理方式： </p>
<ul>
<li>如果 U 比特置 1，则对于未知类型的 LSA 按照 LSA 中的 LS Type 字段描述的泛洪范围进行泛洪；</li>
<li>如果 U 比特置 0，对于未知类型的 LSA 仅在链路范围内泛洪。</li>
</ul>
</li>
<li><p>LSA的泛洪范围已经被明确地定义在LSA的LS Type字段，目前，有三种LSA泛洪范围。 </p>
<ul>
<li>链路本地范围(Link-local Scope)。<ul>
<li>LSA 只在本地链路上泛洪，不会超出这个范围， Link-LSA(新增)。</li>
</ul>
</li>
<li>区域范围(Area Scope)。<ul>
<li> Router-LSA, Network-LSA, Inter-Area-Prefix-LSA, Inter-Area-Router-LSA, Intra-Area-Prefix-LSA(新增)都是区域范围泛洪的 LSA。 </li>
</ul>
</li>
<li>自治系统范围(AS Scope)。<ul>
<li>LSA 将被泛洪到整个路由域，AS-External-LSA。</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/38.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/39.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/40.png"></p>
<blockquote>
<ul>
<li>OSPFv3新增了Link-LSA和Intra Area Prefix LSA。<ul>
<li>Router LSA 不再包含地址信息，使能 OSPFv3 的路由器为它所连接的每条链路产生单独的 Link-LSA，将当前接口的链路本地地址以及路由器在这条链路上的一系列 IPv6 地址信息向该链路上的所有其它路由器通告。</li>
<li>Router LSA 和 Network LSA 中不再包含路由信息，这两类 LSA 中所携带的路由信息由 Intra Area Prefix LSA 来描述，该类 LSA 用来公告一个或多个IPv6 地址前缀。 </li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/41.png"></p>
<blockquote>
<ul>
<li><p>在OSPFv2中，使用“IP网段＋掩码”来表示前缀信息，而且两段信息在不同LSA中的位置还各不相同，结构很不清晰。在OSPFv3的LSA中，使用专门的三元组（Prefix-Length, PrefixOptions, Prefix）来表示前缀信息。由LSA公告的每个前缀都拥有一个自己的PrefixOptions 字段。</p>
</li>
<li><p>Prefix-Length</p>
<ul>
<li>1字节。前缀的bit位长度，对于缺省路由该字段取值为0。</li>
<li>PrefixOptions，1字节。前缀信息的选项，用来描述前缀的某些特殊属性字段，格式如下：</li>
<li>NU位：非单播位。如果设置为1，则这个前缀不会纳入IPv6单播路由计算中。</li>
<li>LA位：本地地址位。如果设置为1，则这个前缀是路由器的一个接口地址。</li>
<li>MC位：组播位。如果设置为1，则这个前缀应该纳入组播计算中，否则不纳入组播计算。</li>
<li>P位：传播位。如果一个NSSA区域的前缀需要被ABR传播出去，就需要设置这一位。</li>
</ul>
</li>
<li><p>Prefix</p>
<ul>
<li>长度不定，为4字节的倍数。用于表示前缀的IPv6网络地址信息。</li>
</ul>
</li>
<li><p>Prefix-length可变，但必须是32bit（4字节）的整数倍，可用0来填充。因此它的长度可能是0、4、8、12、16字节。</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/42.png"></p>
<blockquote>
<ul>
<li>W：用于组播路由；</li>
<li>V：该路由器为虚连接的一端；</li>
<li>E：该路由器为ASBR；</li>
<li>B：该路由器为ABR。</li>
<li>Type：1字节。路由器的该链路的链路类型；</li>
<li>Metric：2字节。数据报文从此接口发出时的cost值；</li>
<li>Interface ID：4字节。接口ID，用于标识接口，无地址含义。</li>
<li>Neighbor Interface ID：4字节。邻居接口ID。</li>
<li>Neighbor Router ID：4字节。邻居Router ID。 </li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/43.png"></p>
<blockquote>
<ul>
<li>Router-LSA具有区域泛洪范围，用于描述该路由器在某个区域内的所有连接，而且只描述建立了邻接关系的连接（邻居为full状态）。这意味着Stub类型的链路不在这里描述了（在OSPFv2中用链路类型3描述）。另外，如果是点到多点链路的话，需要为每个邻居都产生一个描述。由于每个链路描述的长度固定，因此可以通过LSA头中的LSA长度来确定Router-LSA中的Link数。</li>
<li> 一个Router-LSA可以包含多个链路描述（link description）。同一个路由器可以生成多个Router-LSA，通过Link State ID进行区分。在SPF计算时，对于同一个路由器产生的多个Router-LSA必须合在一起参与运算。</li>
<li>OSPFv3的Router-LSA中不再包含前缀信息，仅仅描述了拓扑连接情况。</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/44.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/45.png"></p>
<blockquote>
<ul>
<li><p>Options：3字节。含义见第36页。该字段实际上是该链路上所有路由器的Link-LSA的Options字段的集合，也即是它们的能力集合。</p>
</li>
<li><p>Attached Router：</p>
<ul>
<li>每个路由器4字节。该链路上所有与DR有Full关系的路由器的Router ID。</li>
<li>OSPFv3的Network-LSA具有区域泛洪范围，由DR生成。它的Link State ID为DR的Interface ID，而且将OSPFv2中的掩码字段取消了，所以它不再包含前缀信息，而仅仅描述了拓扑连接情况。</li>
<li>另外，由于其中的Options字段为链路上所有路由器的能力集合，因此DR的能力大小并不会影响其他路由器的LSA传播。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/46.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/47.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/48.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/49.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/50.png"></p>
<blockquote>
<ul>
<li>OSPFv3的Intra-Area-Prefix-LSA具有区域泛洪范围，用于发布区域内前缀信息。根据所参考的LSA不同可分为以下两种情况：<ul>
<li>参考Router-LSA，由各路由器分别生成，用于发布点到点链路的前缀信息以及Stub网络的前缀信息；</li>
<li>参考Network-LSA，由DR生成，用于发布该链路对应网络上的所有前缀信息，这些前缀来自链路上所有路由器各自生成的Link-LSA。但是，Link-LSA中的本地链路地址信息、NU或LA位置1的前缀除外。</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/51.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/52.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/53.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/54.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/55.png"></p>
<blockquote>
<ul>
<li>Metric：20bit。表示ABR到达该前缀描述的路由的cost值。</li>
<li>前缀信息：描述前缀的Prefix三元组。</li>
<li>在OSPFv2中，使用LSA头里面的Link State ID字段来表示网络地址，掩码包含在LSA内容里。</li>
<li>OSPFv3的Inter-Area-Prefix-LSA中，LSA头里的Link State ID不再包含前缀信息，仅仅是一个32位的编号，用于区分同一路由器产生的不同LSA，所有前缀均通过Prefix三元组来描述。</li>
<li>Inter-Area-Prefix-LSA具有区域泛洪范围，由ABR生成。每个Inter-Area-Prefix-LSA包含一条地址前缀信息，且不能包含本地链路地址信息。</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/56.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/57.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/58.png"></p>
<blockquote>
<ul>
<li>Options：3字节，并非生成LSA的路由器的能力描述，而是描述了目的ASBR的能力。</li>
<li> Metric：3字节，表示ABR到目的ASBR路由器的cost值。</li>
<li> Destination Router ID：4字节，目的ASBR路由器的Router ID。</li>
<li>在OSPFv2中，使用LSA头里面的Link State ID字段来表示目的ASBR的Router ID。OSPFv3的Inter-Area-Router-LSA中，LSA头里的Link State ID不再有具体含义，仅仅是一个32位的编号，用于区分同一路由器产生的不同LSA。</li>
<li>Inter-Area-Router-LSA具有区域泛洪范围，由ABR生成。每个Inter-Area-Router-LSA包含一条目的ASBR信息。</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/59.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/60.png"></p>
<blockquote>
<ul>
<li><p>E：外部路由的Metric类型。如果设置为1，表示此为2类外部路由，其Metric不随着路由的传递而增长。如果设置为0，表示此为1类外部路由，其Metric随着路由的传递而增长。</p>
</li>
<li><p>F：如果设置为1，则表示后面的Forwarding Address可选字段存在。</p>
</li>
<li><p>T：如果设置为1，则表示后面的External Route Tag可选字段存在。</p>
</li>
<li><p>前缀信息：描述前缀的Prefix三元组。</p>
</li>
<li><p>Ref LS Type：2字节。如果非0，则表示后面的Referenced Link State ID可选字段存在。</p>
</li>
<li><p>Forwarding Address：16字节。可选的128位IPv6地址。当前面的F位为1时存在。表示到达目的的数据应该转发到这个地址。在公告路由器不是最优的下一跳的时候可以使用。</p>
</li>
<li><p>External Route Tag：4字节。可选的标记位。可以用于ASBR之间的通信。一个比较常见的例子是，在OSPF自治系统的两个边界路由器上进行路由分发时，通过对引入的路由进行标记，可以很方便地进行路由过滤。</p>
</li>
<li><p>Referenced Link State ID：4字节。当前面的Ref LS Type字段非0时存在。如果存在，说明此条外部路由有一些相关信息需要参考另外一个LSA。被参考的LSA由以下字段值确定：</p>
<ul>
<li>其LS type等于此AS-external-LSA的Referenced LS Type；</li>
<li>其Link State ID等于此AS-external-LSA的Referenced Link State ID；</li>
<li>其Advertising Router等于此ASexternal-LSA的Advertising Router。</li>
<li>这种参考能力是为未来的扩展准备的，目前并没有使用。</li>
</ul>
</li>
<li><p>在OSPFv2中，使用LSA头里面的Link State ID字段来表示网络地址，掩码包含在LSA内容里。</p>
</li>
<li><p>OSPFv3的AS-external-LSA中，LSA头里的Link State ID不再包含前缀信息，仅仅是一个32位的编号，用于区分同一路由器产生的不同LSA，所有前缀均通过Prefix三元组来描述。</p>
</li>
<li><p>AS-external-LSA具有AS泛洪范围，由ASBR生成。每个AS-external-LSA包含一条地址前缀信息，且不能包含本地链路地址信息。</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/61.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/62.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/63.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/64.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/65.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/66.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/67.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/68.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/69.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/70.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/71.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/72.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/73.png"></p>
<p><img src="/2021/08/04/IE-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/74.png"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/HCRSE-104-OSPF%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/" rel="tag"># HCRSE-104-OSPF双栈原理</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/07/26/IE-IPv6%E5%9F%BA%E7%A1%80/" rel="next" title="IE-IPv6基础">
                <i class="fa fa-chevron-left"></i> IE-IPv6基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/08/06/IE-ISIS%E5%8F%8C%E6%A0%88%E5%8E%9F%E7%90%86/" rel="prev" title="IE-ISIS双栈原理">
                IE-ISIS双栈原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/mydog.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">79</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">81</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zsy9959" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:zsy9959@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张思宇</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
